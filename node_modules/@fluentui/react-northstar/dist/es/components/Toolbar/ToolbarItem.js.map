{"version":3,"file":"ToolbarItem.js","names":["toolbarItemBehavior","compose","getElementType","mergeVariablesOverrides","useUnhandledProps","useFluentContext","useAccessibility","useStyles","useTelemetry","useContextSelectors","handleRef","Ref","EventListener","Unstable_NestingAuto","customPropTypes","PropTypes","React","createShorthand","doesNodeContainClick","commonPropTypes","childrenExist","partitionPopperPropsFromShorthand","Popper","ToolbarMenu","Popup","ToolbarVariablesContext","ToolbarVariablesProvider","ToolbarItemWrapper","ToolbarItemIcon","ToolbarMenuContext","toolbarItemClassName","ToolbarItem","props","ref","composeOptions","context","displayName","telemetry","setStart","setEnd","accessibility","active","className","design","icon","children","disabled","disabledFocusable","popup","menuOpen","wrapper","styles","variables","menu","positioningProps","itemRef","useRef","menuRef","parentVariables","useContext","mergedVariables","menuSlot","v","slots","getA11yProps","debugName","actionHandlers","performClick","event","preventDefault","handleClick","performWrapperClick","handleWrapperClick","closeMenuAndFocusTrigger","trySetMenuOpen","current","doNotNavigateNextToolbarItem","stopPropagation","mapPropsToBehavior","as","String","hasMenu","hasPopup","rtl","mapPropsToStyles","mapPropsToInlineStyles","unstable_props","classes","handleBlur","e","handleFocus","nativeEvent","target","handleOutsideClick","getRefs","isItemClick","isNestedClick","childRef","isInside","newValue","handleMenuOverrides","predefinedProps","onBlur","isInsideOrMenuTrigger","contains","relatedTarget","onItemClick","itemProps","ElementType","slotProps","resolveSlotProps","unhandledProps","handledProps","itemElement","node","root","onFocus","onClick","submenuElement","nestingRef","defaultProps","overrideProps","popupElement","trigger","undefined","contentElement","wrapperElement","trapFocus","shorthandConfig","mappedProp","propTypes","createCommon","bool","shorthandAllowingChildren","oneOfType","arrayOf","onMenuOpenChange","func","shape","never","string"],"sources":["components/Toolbar/ToolbarItem.tsx"],"sourcesContent":["import { Accessibility, toolbarItemBehavior, ToolbarItemBehaviorProps } from '@fluentui/accessibility';\nimport {\n  compose,\n  getElementType,\n  mergeVariablesOverrides,\n  useUnhandledProps,\n  useFluentContext,\n  useAccessibility,\n  useStyles,\n  useTelemetry,\n  useContextSelectors,\n} from '@fluentui/react-bindings';\nimport { handleRef, Ref } from '@fluentui/react-component-ref';\nimport { EventListener } from '@fluentui/react-component-event-listener';\nimport { GetRefs, NodeRef, Unstable_NestingAuto } from '@fluentui/react-component-nesting-registry';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport * as _ from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\n\nimport {\n  createShorthand,\n  doesNodeContainClick,\n  UIComponentProps,\n  ChildrenComponentProps,\n  ContentComponentProps,\n  commonPropTypes,\n  childrenExist,\n} from '../../utils';\nimport { ComponentEventHandler, ShorthandValue, ShorthandCollection } from '../../types';\nimport { partitionPopperPropsFromShorthand, Popper, PopperShorthandProps } from '../../utils/positioner';\n\nimport { ToolbarMenu, ToolbarMenuProps } from './ToolbarMenu';\nimport { Popup, PopupProps } from '../Popup/Popup';\nimport { ToolbarMenuItemProps } from '../Toolbar/ToolbarMenuItem';\nimport { ToolbarItemShorthandKinds } from './Toolbar';\nimport { ToolbarVariablesContext, ToolbarVariablesProvider } from './toolbarVariablesContext';\nimport { ToolbarItemWrapper, ToolbarItemWrapperProps } from './ToolbarItemWrapper';\nimport { ToolbarItemIcon, ToolbarItemIconProps } from './ToolbarItemIcon';\nimport { ToolbarItemSubscribedValue, ToolbarMenuContext } from './toolbarMenuContext';\n\nexport interface ToolbarItemProps extends UIComponentProps, ChildrenComponentProps, ContentComponentProps {\n  /** Accessibility behavior if overridden by the user. */\n  accessibility?: Accessibility<ToolbarItemBehaviorProps>;\n\n  /** A toolbar item can be active. */\n  active?: boolean;\n\n  /** A toolbar item can show it is currently unable to be interacted with. */\n  disabled?: boolean;\n\n  /** A toolbar item can be disabled and focusable at the same time. */\n  disabledFocusable?: boolean;\n\n  /** Name or shorthand for Toolbar Item Icon */\n  icon?: ShorthandValue<ToolbarItemIconProps>;\n\n  /**\n   * Shorthand for the submenu.\n   * If submenu is specified, the item is wrapped to group the item and the menu elements together.\n   */\n  menu?:\n    | ShorthandValue<ToolbarMenuProps & { popper?: PopperShorthandProps }>\n    | ShorthandCollection<ToolbarMenuItemProps, ToolbarItemShorthandKinds>;\n\n  /** Indicates if the menu inside the item is open. */\n  menuOpen?: boolean;\n\n  /**\n   * Event for request to change 'menuOpen' value.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props and proposed value.\n   */\n  onMenuOpenChange?: ComponentEventHandler<ToolbarItemProps>;\n\n  /**\n   * Called on click.\n   *\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onClick?: ComponentEventHandler<ToolbarItemProps>;\n\n  /**\n   * Called after user's focus.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onFocus?: ComponentEventHandler<ToolbarItemProps>;\n\n  /**\n   * Called after item blur.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onBlur?: ComponentEventHandler<ToolbarItemProps>;\n\n  /**\n   * Attaches a `Popup` component to the ToolbarItem.\n   * Accepts all props as a `Popup`, except `trigger` and `children`.\n   * Traps focus by default.\n   * @see PopupProps\n   */\n  popup?: Omit<PopupProps, 'trigger' | 'children'> | string;\n\n  /** Shorthand for the wrapper component. The item is wrapped only if it contains a menu! */\n  wrapper?: ShorthandValue<ToolbarItemWrapperProps>;\n}\n\nexport type ToolbarItemStylesProps = Required<Pick<ToolbarItemProps, 'active' | 'disabled' | 'disabledFocusable'>>;\n\nexport const toolbarItemClassName = 'ui-toolbar__item';\n\n/**\n * A ToolbarItem renders Toolbar item as a button with an icon.\n */\nexport const ToolbarItem = compose<'button', ToolbarItemProps, ToolbarItemStylesProps, {}, {}>(\n  (props, ref, composeOptions) => {\n    const context = useFluentContext();\n    const { setStart, setEnd } = useTelemetry(composeOptions.displayName, context.telemetry);\n    setStart();\n\n    const {\n      accessibility,\n      active,\n      className,\n      design,\n      icon,\n      children,\n      disabled,\n      disabledFocusable,\n      popup,\n      menuOpen,\n      wrapper,\n      styles,\n      variables,\n    } = props;\n    const [menu, positioningProps] = partitionPopperPropsFromShorthand(props.menu);\n\n    const itemRef = React.useRef<HTMLElement>();\n    const menuRef = React.useRef<HTMLElement>();\n\n    const parentVariables = React.useContext(ToolbarVariablesContext);\n    const mergedVariables = mergeVariablesOverrides(parentVariables, variables);\n\n    const { menuSlot } = (useContextSelectors(ToolbarMenuContext, {\n      menuSlot: v => v.slots.menu,\n    }) as unknown) as ToolbarItemSubscribedValue; // TODO: we should improve typings for the useContextSelectors\n\n    const getA11yProps = useAccessibility(accessibility, {\n      debugName: composeOptions.displayName,\n      actionHandlers: {\n        performClick: event => {\n          event.preventDefault();\n          handleClick(event);\n        },\n        performWrapperClick: event => {\n          handleWrapperClick(event);\n        },\n        closeMenuAndFocusTrigger: event => {\n          trySetMenuOpen(false, event);\n          _.invoke(itemRef.current, 'focus');\n        },\n        doNotNavigateNextToolbarItem: event => {\n          event.stopPropagation();\n        },\n      },\n      mapPropsToBehavior: () => ({\n        as: String(props.as),\n        disabled,\n        disabledFocusable,\n        hasMenu: !!menu,\n        hasPopup: !!popup,\n        menuOpen,\n        active,\n      }),\n      rtl: context.rtl,\n    });\n    const { classes } = useStyles<ToolbarItemStylesProps>(composeOptions.displayName, {\n      className: composeOptions.className,\n      composeOptions,\n      mapPropsToStyles: () => ({ active, disabled, disabledFocusable }),\n      mapPropsToInlineStyles: () => ({\n        className,\n        design,\n        styles,\n        variables: mergedVariables,\n      }),\n      rtl: context.rtl,\n      unstable_props: props,\n    });\n\n    const handleBlur = (e: React.SyntheticEvent) => {\n      _.invoke(props, 'onBlur', e, props);\n    };\n\n    const handleFocus = (e: React.SyntheticEvent) => {\n      _.invoke(props, 'onFocus', e, props);\n    };\n\n    const handleClick = (e: React.MouseEvent | React.KeyboardEvent) => {\n      if (disabled || disabledFocusable) {\n        e.preventDefault();\n        return;\n      }\n\n      if (menu) {\n        trySetMenuOpen(!menuOpen, e);\n      }\n\n      _.invoke(props, 'onClick', e, props);\n    };\n\n    const handleWrapperClick = (e: React.MouseEvent | React.KeyboardEvent) => {\n      if (menu) {\n        if (doesNodeContainClick(menuRef.current, e.nativeEvent as MouseEvent, context.target, false)) {\n          trySetMenuOpen(false, e);\n        }\n      }\n    };\n\n    const handleOutsideClick = (getRefs: GetRefs) => (e: MouseEvent) => {\n      const isItemClick = doesNodeContainClick(itemRef.current, e, context.target);\n      const isNestedClick = _.some(getRefs(), (childRef: NodeRef) => {\n        return doesNodeContainClick(childRef.current as HTMLElement, e, context.target);\n      });\n      const isInside = isItemClick || isNestedClick;\n\n      if (!isInside) {\n        trySetMenuOpen(false, e);\n      }\n    };\n\n    const trySetMenuOpen = (newValue: boolean, e: Event | React.SyntheticEvent) => {\n      _.invoke(props, 'onMenuOpenChange', e, { ...props, menuOpen: newValue });\n    };\n\n    const handleMenuOverrides = (getRefs: GetRefs) => (predefinedProps: ToolbarMenuProps) => ({\n      onBlur: (e: React.FocusEvent) => {\n        const isInsideOrMenuTrigger = _.some(getRefs(), (childRef: NodeRef) => {\n          return (\n            childRef.current.contains(e.relatedTarget as HTMLElement) ||\n            itemRef.current.contains(e.relatedTarget as HTMLElement)\n          );\n        });\n\n        if (!isInsideOrMenuTrigger) {\n          trySetMenuOpen(false, e);\n        }\n      },\n      onItemClick: (e, itemProps: ToolbarMenuItemProps) => {\n        const { popup, menuOpen } = itemProps;\n        _.invoke(predefinedProps, 'onItemClick', e, itemProps);\n        if (popup) {\n          return;\n        }\n        // TODO: should we pass toolbarMenuItem to the user callback so he can decide if he wants to close the menu?\n        trySetMenuOpen(menuOpen, e);\n      },\n    });\n\n    const ElementType = getElementType(props);\n    const slotProps = composeOptions.resolveSlotProps<ToolbarItemProps>(props);\n    const unhandledProps = useUnhandledProps(composeOptions.handledProps, props);\n\n    const itemElement = (\n      <Ref\n        innerRef={node => {\n          itemRef.current = node;\n          handleRef(ref, node);\n        }}\n      >\n        <ElementType\n          {...getA11yProps('root', {\n            ...unhandledProps,\n            disabled,\n            className: classes.root,\n            onBlur: handleBlur,\n            onFocus: handleFocus,\n            onClick: handleClick,\n          })}\n        >\n          {childrenExist(children) ? children : createShorthand(composeOptions.slots.icon, icon, slotProps.icon)}\n        </ElementType>\n      </Ref>\n    );\n\n    const submenuElement = menuOpen ? (\n      <Unstable_NestingAuto>\n        {(getRefs, nestingRef) => {\n          return (\n            <>\n              <Ref\n                innerRef={(node: HTMLElement) => {\n                  nestingRef.current = node;\n                  menuRef.current = node;\n                }}\n              >\n                <Popper align=\"start\" position=\"above\" targetRef={itemRef} {...positioningProps}>\n                  <ToolbarVariablesProvider value={mergedVariables}>\n                    {createShorthand(composeOptions.slots.menu || menuSlot || ToolbarMenu, menu, {\n                      defaultProps: () => slotProps.menu,\n                      overrideProps: handleMenuOverrides(getRefs),\n                    })}\n                  </ToolbarVariablesProvider>\n                </Popper>\n              </Ref>\n              <EventListener listener={handleOutsideClick(getRefs)} target={context.target} type=\"click\" capture />\n            </>\n          );\n        }}\n      </Unstable_NestingAuto>\n    ) : null;\n\n    if (popup) {\n      const popupElement = createShorthand(composeOptions.slots.popup, popup, {\n        defaultProps: () => slotProps.popup,\n        overrideProps: {\n          trigger: itemElement,\n          children: undefined, // force-reset `children` defined for `Popup` as it collides with the `trigger`\n        },\n      });\n      setEnd();\n\n      return popupElement;\n    }\n\n    // wrap the item if it has menu (even if it is closed = not rendered)\n    if (menu) {\n      const contentElement = (\n        <>\n          {itemElement}\n          {submenuElement}\n        </>\n      );\n\n      if (wrapper) {\n        const wrapperElement = createShorthand(composeOptions.slots.wrapper, wrapper, {\n          defaultProps: () => getA11yProps('wrapper', slotProps.wrapper || {}),\n          overrideProps: predefinedProps => ({\n            children: contentElement,\n            onClick: e => {\n              handleWrapperClick(e);\n              _.invoke(predefinedProps, 'onClick', e);\n            },\n          }),\n        });\n        setEnd();\n\n        return wrapperElement;\n      }\n\n      setEnd();\n      return contentElement;\n    }\n\n    setEnd();\n\n    return itemElement;\n  },\n  {\n    className: toolbarItemClassName,\n    displayName: 'ToolbarItem',\n\n    slots: {\n      icon: ToolbarItemIcon,\n      wrapper: ToolbarItemWrapper,\n      popup: Popup, // TODO: compose Popup to ToolbarItemPopup once it has compose functionality\n    },\n\n    slotProps: () => ({\n      popup: { trapFocus: true },\n    }),\n\n    shorthandConfig: { mappedProp: 'content' },\n    handledProps: [\n      'accessibility',\n      'as',\n      'children',\n      'className',\n      'content',\n      'design',\n      'styles',\n      'disabledFocusable',\n      'variables',\n      'active',\n      'disabled',\n      'icon',\n      'menu',\n      'menuOpen',\n      'onMenuOpenChange',\n      'onClick',\n      'onFocus',\n      'onBlur',\n      'popup',\n      'wrapper',\n    ],\n  },\n);\n\nToolbarItem.propTypes = {\n  ...commonPropTypes.createCommon(),\n  active: PropTypes.bool,\n  disabled: PropTypes.bool,\n  disabledFocusable: PropTypes.bool,\n  icon: customPropTypes.shorthandAllowingChildren,\n  menu: PropTypes.oneOfType([\n    customPropTypes.shorthandAllowingChildren,\n    PropTypes.arrayOf(customPropTypes.shorthandAllowingChildren),\n  ]),\n  menuOpen: PropTypes.bool,\n  onMenuOpenChange: PropTypes.func,\n  onClick: PropTypes.func,\n  onFocus: PropTypes.func,\n  onBlur: PropTypes.func,\n  popup: PropTypes.oneOfType([\n    PropTypes.shape({\n      ...Popup.propTypes,\n      trigger: customPropTypes.never,\n      children: customPropTypes.never,\n    }),\n    PropTypes.string,\n  ]),\n  wrapper: customPropTypes.shorthandAllowingChildren,\n};\nToolbarItem.defaultProps = {\n  as: 'button',\n  accessibility: toolbarItemBehavior,\n  wrapper: {},\n};\n"],"mappings":"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"}