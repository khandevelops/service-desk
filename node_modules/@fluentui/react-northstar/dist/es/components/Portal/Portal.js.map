{"version":3,"file":"Portal.js","names":["FocusTrapZone","useFluentContext","useTelemetry","useAutoControlled","EventListener","handleRef","Ref","customPropTypes","PropTypes","React","childrenExist","doesNodeContainClick","commonPropTypes","rtlTextContainer","createShorthandFactory","PortalInner","Portal","props","context","displayName","telemetry","setStart","setEnd","children","content","trapFocus","trigger","triggerAccessibility","portalRef","useRef","triggerRef","defaultValue","defaultOpen","value","open","initialValue","setOpen","renderPortal","contentToRender","focusTrapZoneProps","length","handleMount","handleUnmount","getAttributes","forElements","handleDocumentClick","target","renderTrigger","handleTriggerRef","cloneElement","onClick","handleTriggerClick","attributes","keyHandlers","node","current","e","unhandledProps","isOpen","element","propTypes","createCommon","accessibility","as","className","styled","bool","onMount","func","onUnmount","ref","object","onTriggerClick","onOutsideClick","oneOfType","handledProps","Object","keys","create","Component","defaultProps"],"sources":["components/Portal/Portal.tsx"],"sourcesContent":["import { AccessibilityAttributes } from '@fluentui/accessibility';\nimport {\n  AccessibilityHandlerProps,\n  FocusTrapZone,\n  FocusTrapZoneProps,\n  useFluentContext,\n  useTelemetry,\n  useAutoControlled,\n} from '@fluentui/react-bindings';\nimport { EventListener } from '@fluentui/react-component-event-listener';\nimport { handleRef, Ref } from '@fluentui/react-component-ref';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport * as _ from 'lodash';\nimport { FluentComponentStaticProps } from '../../types';\nimport {\n  childrenExist,\n  doesNodeContainClick,\n  ChildrenComponentProps,\n  commonPropTypes,\n  ContentComponentProps,\n  rtlTextContainer,\n  createShorthandFactory,\n} from '../../utils';\nimport { PortalInner } from './PortalInner';\n\nexport type TriggerAccessibility = {\n  attributes?: AccessibilityAttributes;\n  keyHandlers?: AccessibilityHandlerProps;\n};\n\nexport interface PortalProps extends ChildrenComponentProps, ContentComponentProps {\n  /** Initial value of open. */\n  defaultOpen?: boolean;\n\n  /**\n   * Called when the portal is mounted on the DOM.\n   *\n   * @param data - All props.\n   */\n  onMount?: (props: PortalProps) => void;\n\n  /**\n   * Called when the portal is unmounted from the DOM.\n   *\n   * @param data - All props.\n   */\n  onUnmount?: (props: PortalProps) => void;\n\n  /** Controls whether or not the portal is displayed. */\n  open?: boolean;\n\n  /** Element to be rendered in-place where the portal is defined. */\n  trigger?: JSX.Element;\n\n  /** Controls whether or not focus trap should be applied, using boolean or FocusTrapZoneProps type value */\n  trapFocus?: FocusTrapZoneProps | boolean;\n\n  /** Accessibility behavior object to apply on trigger node. */\n  triggerAccessibility?: TriggerAccessibility;\n\n  /** Sets trigger node to passed ref. */\n  triggerRef?: React.Ref<any>;\n\n  /**\n   * Called when trigger node was clicked.\n   *\n   * @param data - All props.\n   */\n  onTriggerClick?: (e: React.MouseEvent) => void;\n\n  /**\n   * Called when `click` event was invoked outside portal or trigger nodes.\n   *\n   * @param data - All props.\n   */\n  onOutsideClick?: (e: React.MouseEvent) => void;\n}\n\n/**\n * (DEPRECATED) A Portal allows to render children outside of their parent.\n *\n * @deprecated Please use \"Popup\" or \"Dialog\" components instead.\n */\nexport const Portal: React.FC<PortalProps> & FluentComponentStaticProps<PortalProps> = props => {\n  const context = useFluentContext();\n  const { setStart, setEnd } = useTelemetry(Portal.displayName, context.telemetry);\n  setStart();\n  const { children, content, trapFocus, trigger, triggerAccessibility } = props;\n  const portalRef = React.useRef<HTMLElement>();\n  const triggerRef = React.useRef<HTMLElement>();\n\n  const [open, setOpen] = useAutoControlled({\n    defaultValue: props.defaultOpen,\n    value: props.open,\n    initialValue: false,\n  });\n\n  const renderPortal = (): JSX.Element | undefined => {\n    const contentToRender = childrenExist(children) ? children : content;\n    const focusTrapZoneProps = (_.keys(trapFocus).length && trapFocus) || {};\n    return (\n      open && (\n        <Ref innerRef={portalRef}>\n          <PortalInner\n            onMount={handleMount}\n            onUnmount={handleUnmount}\n            {...rtlTextContainer.getAttributes({ forElements: [contentToRender] })}\n          >\n            {trapFocus ? <FocusTrapZone {...focusTrapZoneProps}>{contentToRender}</FocusTrapZone> : contentToRender}\n            <EventListener listener={handleDocumentClick} target={context.target} type=\"click\" />\n          </PortalInner>\n        </Ref>\n      )\n    );\n  };\n\n  const renderTrigger = (): JSX.Element | undefined => {\n    return (\n      trigger && (\n        <Ref innerRef={handleTriggerRef}>\n          {React.cloneElement(trigger, {\n            onClick: handleTriggerClick,\n            ...triggerAccessibility.attributes,\n            ...triggerAccessibility.keyHandlers,\n          })}\n        </Ref>\n      )\n    );\n  };\n\n  const handleMount = () => {\n    _.invoke(props, 'onMount', props);\n  };\n\n  const handleUnmount = () => {\n    _.invoke(props, 'onUnmount', props);\n  };\n\n  const handleTriggerRef = (node: HTMLElement) => {\n    triggerRef.current = node;\n    handleRef(props.triggerRef, node);\n  };\n\n  const handleTriggerClick = (e: React.MouseEvent, ...unhandledProps) => {\n    _.invoke(props, 'onTriggerClick', e); // Call handler from parent component\n    _.invoke(trigger, 'props.onClick', e, ...unhandledProps); // Call original event handler\n    setOpen(isOpen => !isOpen);\n  };\n\n  const handleDocumentClick = (e: MouseEvent) => {\n    if (\n      !portalRef || // no portal\n      doesNodeContainClick(triggerRef.current, e, context.target) || // event happened in trigger (delegate to trigger handlers)\n      doesNodeContainClick(portalRef.current, e, context.target) // event happened in the portal\n    ) {\n      return; // ignore the click\n    }\n    _.invoke(props, 'onOutsideClick', e);\n    setOpen(false);\n  };\n\n  const element = (\n    <>\n      {renderPortal()}\n      {renderTrigger()}\n    </>\n  );\n  setEnd();\n  return element;\n};\n\nPortal.propTypes = {\n  ...commonPropTypes.createCommon({\n    accessibility: false,\n    as: false,\n    className: false,\n    styled: false,\n  }),\n  defaultOpen: PropTypes.bool,\n  onMount: PropTypes.func,\n  onUnmount: PropTypes.func,\n  open: PropTypes.bool,\n  trigger: PropTypes.element,\n  triggerRef: customPropTypes.ref,\n  triggerAccessibility: PropTypes.object,\n  onTriggerClick: PropTypes.func,\n  onOutsideClick: PropTypes.func,\n  trapFocus: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]),\n};\n\nPortal.handledProps = Object.keys(Portal.propTypes) as any;\n\nPortal.create = createShorthandFactory({\n  Component: Portal,\n});\n\nPortal.defaultProps = {\n  triggerAccessibility: {},\n};\n"],"mappings":"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"}