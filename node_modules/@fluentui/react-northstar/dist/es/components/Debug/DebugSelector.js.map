{"version":3,"file":"DebugSelector.js","names":["PropTypes","React","EventListener","isBrowser","FiberNavigator","DebugRect","INITIAL_STATE","fiberNav","DebugSelector","state","debugDOMNode","domNode","fromDOMNode","console","error","props","filter","setCurrentFiberNav","setState","prevState","__fiber","onHover","handleMouseMove","e","target","handleMouseLeave","handleDOMNodeClick","preventDefault","stopPropagation","onSelect","render","active","mountDocument","renderLabel","showBackground","showClassName","showCropMarks","showElement","body","Component","defaultProps","window","document","propTypes","object","isRequired"],"sources":["components/Debug/DebugSelector.tsx"],"sourcesContent":["import * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { EventListener } from '@fluentui/react-component-event-listener';\n\nimport { isBrowser } from '../../utils';\n\nimport { FiberNavigator } from './FiberNavigator';\nimport { DebugRect } from './DebugRect';\n\nexport type DebugSelectorProps = {\n  /** Existing document the popup should add listeners. */\n  mountDocument?: Document;\n  onSelect?: (fiberNav: FiberNavigator) => void;\n  onHover?: (fiberNav: FiberNavigator) => void;\n  renderLabel?: (fiberNav: FiberNavigator) => string;\n  showBackground?: boolean;\n  showClassName?: boolean;\n  showCropMarks?: boolean;\n  showElement?: boolean;\n  filter?: (fiberNav: FiberNavigator) => FiberNavigator | null;\n  active?: boolean;\n};\n\nexport type DebugSelectorState = {\n  fiberNav: FiberNavigator;\n};\n\nconst INITIAL_STATE: DebugSelectorState = {\n  fiberNav: null,\n};\n\n// TODO: This is a copy and trim-down of Debug.tsx\n//       Cleanup and use in Debug.tsx before merge:\n//         - Make hotkey invocation generic, or take prop for active state\n//           since Debug uses ctrl + 'd' and DebugSelector uses ctrl + 'c' in react-builder\n//\nexport class DebugSelector extends React.Component<DebugSelectorProps, DebugSelectorState> {\n  state = INITIAL_STATE;\n\n  static defaultProps = {\n    active: false,\n    filter: fiberNav => fiberNav,\n    // eslint-disable-next-line no-undef\n    mountDocument: isBrowser() ? window.document : null,\n  };\n\n  static propTypes = {\n    mountDocument: PropTypes.object.isRequired,\n  };\n\n  debugDOMNode = domNode => {\n    let fiberNav = FiberNavigator.fromDOMNode(domNode);\n\n    if (!fiberNav) {\n      // eslint-disable-next-line no-console\n      console.error('No fiber for dom node', domNode);\n      return;\n    }\n\n    fiberNav = this.props.filter(fiberNav);\n\n    this.setCurrentFiberNav(fiberNav);\n  };\n\n  setCurrentFiberNav = (fiberNav: FiberNavigator | null) => {\n    this.setState(prevState => {\n      if (fiberNav?.__fiber !== prevState.fiberNav?.__fiber) {\n        this.props.onHover?.(fiberNav);\n        return { fiberNav };\n      }\n      return null;\n    });\n  };\n\n  handleMouseMove = e => {\n    this.debugDOMNode(e.target);\n  };\n\n  handleMouseLeave = e => {\n    this.setCurrentFiberNav(null);\n  };\n\n  handleDOMNodeClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.props.onSelect?.(this.state.fiberNav);\n  };\n\n  render() {\n    const {\n      active,\n      mountDocument,\n      renderLabel,\n      showBackground,\n      showClassName,\n      showCropMarks,\n      showElement,\n    } = this.props;\n    const { fiberNav } = this.state;\n\n    return (\n      <>\n        {active && <EventListener listener={this.handleMouseMove} target={mountDocument.body} type=\"mousemove\" />}\n        {active && <EventListener listener={this.handleMouseLeave} target={mountDocument.body} type=\"mouseleave\" />}\n        {active && fiberNav && fiberNav.domNode && (\n          <EventListener listener={this.handleDOMNodeClick} target={fiberNav.domNode} type=\"click\" />\n        )}\n        {active && fiberNav && (\n          <DebugRect\n            showBackground={showBackground}\n            showClassName={showClassName}\n            showElement={showElement}\n            showCropMarks={showCropMarks}\n            fiberNav={fiberNav}\n            renderLabel={renderLabel}\n          />\n        )}\n      </>\n    );\n  }\n}\n"],"mappings":"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"}