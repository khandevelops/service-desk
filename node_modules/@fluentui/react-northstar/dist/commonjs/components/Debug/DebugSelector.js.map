{"version":3,"file":"DebugSelector.js","names":["INITIAL_STATE","fiberNav","DebugSelector","state","debugDOMNode","domNode","FiberNavigator","fromDOMNode","console","error","props","filter","setCurrentFiberNav","setState","prevState","__fiber","onHover","handleMouseMove","e","target","handleMouseLeave","handleDOMNodeClick","preventDefault","stopPropagation","onSelect","render","active","mountDocument","renderLabel","showBackground","showClassName","showCropMarks","showElement","body","React","Component","defaultProps","isBrowser","window","document","propTypes","PropTypes","object","isRequired"],"sources":["components/Debug/DebugSelector.tsx"],"sourcesContent":["import * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { EventListener } from '@fluentui/react-component-event-listener';\n\nimport { isBrowser } from '../../utils';\n\nimport { FiberNavigator } from './FiberNavigator';\nimport { DebugRect } from './DebugRect';\n\nexport type DebugSelectorProps = {\n  /** Existing document the popup should add listeners. */\n  mountDocument?: Document;\n  onSelect?: (fiberNav: FiberNavigator) => void;\n  onHover?: (fiberNav: FiberNavigator) => void;\n  renderLabel?: (fiberNav: FiberNavigator) => string;\n  showBackground?: boolean;\n  showClassName?: boolean;\n  showCropMarks?: boolean;\n  showElement?: boolean;\n  filter?: (fiberNav: FiberNavigator) => FiberNavigator | null;\n  active?: boolean;\n};\n\nexport type DebugSelectorState = {\n  fiberNav: FiberNavigator;\n};\n\nconst INITIAL_STATE: DebugSelectorState = {\n  fiberNav: null,\n};\n\n// TODO: This is a copy and trim-down of Debug.tsx\n//       Cleanup and use in Debug.tsx before merge:\n//         - Make hotkey invocation generic, or take prop for active state\n//           since Debug uses ctrl + 'd' and DebugSelector uses ctrl + 'c' in react-builder\n//\nexport class DebugSelector extends React.Component<DebugSelectorProps, DebugSelectorState> {\n  state = INITIAL_STATE;\n\n  static defaultProps = {\n    active: false,\n    filter: fiberNav => fiberNav,\n    // eslint-disable-next-line no-undef\n    mountDocument: isBrowser() ? window.document : null,\n  };\n\n  static propTypes = {\n    mountDocument: PropTypes.object.isRequired,\n  };\n\n  debugDOMNode = domNode => {\n    let fiberNav = FiberNavigator.fromDOMNode(domNode);\n\n    if (!fiberNav) {\n      // eslint-disable-next-line no-console\n      console.error('No fiber for dom node', domNode);\n      return;\n    }\n\n    fiberNav = this.props.filter(fiberNav);\n\n    this.setCurrentFiberNav(fiberNav);\n  };\n\n  setCurrentFiberNav = (fiberNav: FiberNavigator | null) => {\n    this.setState(prevState => {\n      if (fiberNav?.__fiber !== prevState.fiberNav?.__fiber) {\n        this.props.onHover?.(fiberNav);\n        return { fiberNav };\n      }\n      return null;\n    });\n  };\n\n  handleMouseMove = e => {\n    this.debugDOMNode(e.target);\n  };\n\n  handleMouseLeave = e => {\n    this.setCurrentFiberNav(null);\n  };\n\n  handleDOMNodeClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.props.onSelect?.(this.state.fiberNav);\n  };\n\n  render() {\n    const {\n      active,\n      mountDocument,\n      renderLabel,\n      showBackground,\n      showClassName,\n      showCropMarks,\n      showElement,\n    } = this.props;\n    const { fiberNav } = this.state;\n\n    return (\n      <>\n        {active && <EventListener listener={this.handleMouseMove} target={mountDocument.body} type=\"mousemove\" />}\n        {active && <EventListener listener={this.handleMouseLeave} target={mountDocument.body} type=\"mouseleave\" />}\n        {active && fiberNav && fiberNav.domNode && (\n          <EventListener listener={this.handleDOMNodeClick} target={fiberNav.domNode} type=\"click\" />\n        )}\n        {active && fiberNav && (\n          <DebugRect\n            showBackground={showBackground}\n            showClassName={showClassName}\n            showElement={showElement}\n            showCropMarks={showCropMarks}\n            fiberNav={fiberNav}\n            renderLabel={renderLabel}\n          />\n        )}\n      </>\n    );\n  }\n}\n"],"mappings":"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"}