{"version":3,"file":"Popper.js","names":["Popper","props","usesRenderProps","children","proposedPlacement","getPlacement","align","position","rtl","latestPlacement","React","useRef","useState","computedPlacement","setComputedPlacement","popperRef","usePopper","useMergedRefs","onStateUpdate","state","placement","current","targetRef","containerRef","arrowRef","useIsomorphicLayoutEffect","isRefObject","pointerTargetRef","scheduleUpdate","useCallback","updatePosition","child","Children","only","defaultProps","enabled","modifiers","positionFixed","positioningDependencies"],"sources":["utils/positioner/Popper.tsx"],"sourcesContent":["import { useIsomorphicLayoutEffect, useMergedRefs } from '@fluentui/react-bindings';\nimport { Ref, isRefObject } from '@fluentui/react-component-ref';\nimport * as PopperJs from '@popperjs/core';\nimport * as React from 'react';\n\nimport { getPlacement } from './positioningHelper';\nimport { PopperChildrenFn, PopperProps, PopperRefHandle } from './types';\nimport { usePopper } from './usePopper';\n\n/**\n * Popper relies on the 3rd party library [Popper.js](https://github.com/FezVrasta/popper.js) for positioning.\n *\n * @deprecated Please use \"usePopper()\" hook instead.\n */\nexport const Popper: React.FunctionComponent<PopperProps> = props => {\n  const usesRenderProps: boolean = typeof props.children === 'function';\n\n  const proposedPlacement = getPlacement(props.align, props.position, props.rtl);\n  const latestPlacement = React.useRef<PopperJs.Placement>(proposedPlacement);\n  const [computedPlacement, setComputedPlacement] = React.useState<PopperJs.Placement>(proposedPlacement);\n\n  const popperRef = React.useRef<PopperRefHandle | null>(null);\n  const { targetRef, containerRef, arrowRef } = usePopper({\n    ...props,\n\n    popperRef: useMergedRefs(props.popperRef, popperRef),\n    onStateUpdate: state => {\n      // PopperJS performs computations that might update the computed placement: auto positioning, flipping the\n      // placement in case the popper box should be rendered at the edge of the viewport and does not fit\n      if (state.placement !== latestPlacement.current) {\n        latestPlacement.current = state.placement;\n\n        // A state change has sense only if renderProps are passed, otherwise a state value is unused\n        if (usesRenderProps) {\n          setComputedPlacement(state.placement);\n        }\n      }\n    },\n  });\n\n  useIsomorphicLayoutEffect(() => {\n    // A way to sync refs, is needed as Popper component accepts refs as params\n    // Does not make anything worse as Popper component does not have proper handing for ref updates ¯\\_(ツ)_/¯\n    targetRef.current = isRefObject(props.targetRef)\n      ? (props.targetRef as React.RefObject<Element>).current\n      : (props.targetRef as PopperJs.VirtualElement);\n    arrowRef.current = props.pointerTargetRef?.current as HTMLElement;\n  });\n\n  const scheduleUpdate = React.useCallback(() => {\n    popperRef.current?.updatePosition();\n  }, []);\n\n  const child = usesRenderProps\n    ? (props.children as PopperChildrenFn)({\n        placement: computedPlacement,\n        scheduleUpdate,\n      })\n    : (props.children as React.ReactElement);\n\n  return child ? <Ref innerRef={containerRef}>{React.Children.only(child)}</Ref> : null;\n};\n\nPopper.defaultProps = {\n  enabled: true,\n  modifiers: [],\n  positionFixed: false,\n  positioningDependencies: [],\n};\n"],"mappings":";;;;AAAA;AACA;AAEA;AAEA;AAEA;AAAwC;AAAA;AAExC;AACA;AACA;AACA;AACA;AACO,IAAMA,MAA4C,GAAG,SAA/CA,MAA4C,CAAGC,KAAK,EAAI;EACnE,IAAMC,eAAwB,GAAG,OAAOD,KAAK,CAACE,QAAQ,KAAK,UAAU;EAErE,IAAMC,iBAAiB,GAAG,IAAAC,+BAAY,EAACJ,KAAK,CAACK,KAAK,EAAEL,KAAK,CAACM,QAAQ,EAAEN,KAAK,CAACO,GAAG,CAAC;EAC9E,IAAMC,eAAe,GAAGC,KAAK,CAACC,MAAM,CAAqBP,iBAAiB,CAAC;EAC3E,sBAAkDM,KAAK,CAACE,QAAQ,CAAqBR,iBAAiB,CAAC;IAAhGS,iBAAiB;IAAEC,oBAAoB;EAE9C,IAAMC,SAAS,GAAGL,KAAK,CAACC,MAAM,CAAyB,IAAI,CAAC;EAC5D,iBAA8C,IAAAK,qBAAS,oBAClDf,KAAK;MAERc,SAAS,EAAE,IAAAE,4BAAa,EAAChB,KAAK,CAACc,SAAS,EAAEA,SAAS,CAAC;MACpDG,aAAa,EAAE,uBAAAC,KAAK,EAAI;QACtB;QACA;QACA,IAAIA,KAAK,CAACC,SAAS,KAAKX,eAAe,CAACY,OAAO,EAAE;UAC/CZ,eAAe,CAACY,OAAO,GAAGF,KAAK,CAACC,SAAS;;UAEzC;UACA,IAAIlB,eAAe,EAAE;YACnBY,oBAAoB,CAACK,KAAK,CAACC,SAAS,CAAC;UACvC;QACF;MACF;IAAC,GACD;IAhBME,SAAS,cAATA,SAAS;IAAEC,YAAY,cAAZA,YAAY;IAAEC,QAAQ,cAARA,QAAQ;EAkBzC,IAAAC,wCAAyB,EAAC,YAAM;IAAA;IAC9B;IACA;IACAH,SAAS,CAACD,OAAO,GAAG,IAAAK,8BAAW,EAACzB,KAAK,CAACqB,SAAS,CAAC,GAC3CrB,KAAK,CAACqB,SAAS,CAA8BD,OAAO,GACpDpB,KAAK,CAACqB,SAAqC;IAChDE,QAAQ,CAACH,OAAO,4BAAGpB,KAAK,CAAC0B,gBAAgB,qBAAtB,sBAAwBN,OAAsB;EACnE,CAAC,CAAC;EAEF,IAAMO,cAAc,GAAGlB,KAAK,CAACmB,WAAW,CAAC,YAAM;IAAA;IAC7C,sBAAAd,SAAS,CAACM,OAAO,qBAAjB,mBAAmBS,cAAc,EAAE;EACrC,CAAC,EAAE,EAAE,CAAC;EAEN,IAAMC,KAAK,GAAG7B,eAAe,GACxBD,KAAK,CAACE,QAAQ,CAAsB;IACnCiB,SAAS,EAAEP,iBAAiB;IAC5Be,cAAc,EAAdA;EACF,CAAC,CAAC,GACD3B,KAAK,CAACE,QAA+B;EAE1C,OAAO4B,KAAK,gBAAG,oBAAC,sBAAG;IAAC,QAAQ,EAAER;EAAa,GAAEb,KAAK,CAACsB,QAAQ,CAACC,IAAI,CAACF,KAAK,CAAC,CAAO,GAAG,IAAI;AACvF,CAAC;AAAC;AAEF/B,MAAM,CAACkC,YAAY,GAAG;EACpBC,OAAO,EAAE,IAAI;EACbC,SAAS,EAAE,EAAE;EACbC,aAAa,EAAE,KAAK;EACpBC,uBAAuB,EAAE;AAC3B,CAAC"}