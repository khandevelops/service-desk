{"version":3,"file":"resolveStyles.js","names":["_styles2","require","_classnames","_interopRequireDefault","classesCache","WeakMap","stylesCache","resolveStyles","options","resolvedVariables","allDisplayNames","componentClassName","className","theme","primaryDisplayName","componentProps","inlineStylesProps","rtl","disableAnimations","renderer","performanceFlags","performance","telemetry","design","styles","variables","noInlineStylesOverrides","noVariableOverrides","enableBooleanVariablesCaching","process","env","NODE_ENV","enableStylesCaching","Error","_isPlainObject2","default","hasOnlyBooleanVariables","Object","keys","every","variableName","_isNil2","cacheEnabled","mergedStyles","length","componentStyles","root","map","displayName","filter","Boolean","reduce","acc","mergeComponentStyles","withDebugId","styleParam","props","rendererParam","direction","join","sanitizeCss","enableSanitizeCssPlugin","resolvedStylesDebug","has","set","propsCacheKey","JSON","stringify","variablesCacheKey","componentCacheKey","Proxy","resolvedStyles","classes","forEach","slotName","lazyEvaluationKey","slotCacheKey","defineProperty","enumerable","configurable","val","_Object$assign","assign","get","stylesThemeCache","telemetryPartStart","enabled","now","_Object$assign2","isDebugEnabled","_resolvedStyles$slotN","_resolvedStyles$slotN2","msResolveStylesTotal","_Object$assign3","classesThemeCache","stylesRootCacheHits","stylesSlotsCacheHits","cx","styleObj","renderRule","_Object$assign4","resultClassName","msRenderStylesTotal","target","_mergedStyles$slotNam","_mergedStyles","call","_Object$assign5","_target$slotName","_target$slotName2","_Object$assign6","exports"],"sources":["styles/resolveStyles.ts"],"sourcesContent":["import { RendererParam } from '@fluentui/react-northstar-styles-renderer';\nimport {\n  ComponentSlotStylesInput,\n  ComponentSlotStylesPrepared,\n  ComponentSlotStylesResolved,\n  ComponentStyleFunctionParam,\n  ComponentVariablesObject,\n  ICSSInJSStyle,\n  isDebugEnabled,\n  mergeComponentStyles,\n  ThemePrepared,\n  withDebugId,\n} from '@fluentui/styles';\nimport cx from 'classnames';\nimport * as _ from 'lodash';\n\nimport { ComponentSlotClasses, ResolveStylesOptions } from './types';\n\nexport type ResolveStylesResult = {\n  resolvedStyles: ComponentSlotStylesResolved;\n  resolvedStylesDebug: Record<string, { styles: Object }[]>;\n  classes: ComponentSlotClasses;\n};\n\n// this weak map is used as cache for the classes\nconst classesCache = new WeakMap<ThemePrepared, Record<string, string>>();\n\n// this weak map is used as cache for the styles\nconst stylesCache = new WeakMap<ThemePrepared, Record<string, ICSSInJSStyle>>();\n\n/**\n * Both resolvedStyles and classes are objects of getters with lazy evaluation\n *\n * Additionally if the cacheEnabled option is provided, than the resolved styles\n * and classes are caching the results in WeakMaps. The key of the maps contains the following:\n * - theme\n * - displayName\n * - slot name\n * - styling props\n * - rtl mode\n * - disable animations mode\n */\nexport const resolveStyles = (\n  options: ResolveStylesOptions,\n  resolvedVariables: ComponentVariablesObject,\n): ResolveStylesResult => {\n  const {\n    allDisplayNames,\n    className: componentClassName,\n    theme,\n    primaryDisplayName,\n    componentProps,\n    inlineStylesProps,\n    rtl,\n    disableAnimations,\n    renderer,\n    performance: performanceFlags,\n    telemetry,\n  } = options;\n\n  const { className, design, styles, variables } = inlineStylesProps;\n  const noInlineStylesOverrides = !(design || styles);\n\n  let noVariableOverrides = performanceFlags.enableBooleanVariablesCaching || !variables;\n\n  /* istanbul ignore else */\n  if (process.env.NODE_ENV !== 'production') {\n    if (!performanceFlags.enableStylesCaching && performanceFlags.enableBooleanVariablesCaching) {\n      throw new Error(\n        '@fluentui/react-northstar: Please check your \"performance\" settings on \"Provider\", to enable \"enableBooleanVariablesCaching\" you need to enable \"enableStylesCaching\"',\n      );\n    }\n  }\n\n  if (performanceFlags.enableBooleanVariablesCaching) {\n    if (_.isPlainObject(variables)) {\n      const hasOnlyBooleanVariables = Object.keys(variables).every(\n        variableName =>\n          variables[variableName] === null ||\n          typeof variables[variableName] === 'undefined' ||\n          typeof variables[variableName] === 'boolean',\n      );\n\n      if (!hasOnlyBooleanVariables) {\n        noVariableOverrides = false;\n      }\n    } else if (!_.isNil(variables)) {\n      noVariableOverrides = false;\n    }\n  }\n\n  const cacheEnabled = performanceFlags.enableStylesCaching && noInlineStylesOverrides && noVariableOverrides;\n\n  // Merge theme styles with inline overrides if any\n  let mergedStyles: ComponentSlotStylesPrepared;\n\n  if (allDisplayNames.length === 1) {\n    mergedStyles = theme.componentStyles[allDisplayNames[0]] || { root: () => ({}) };\n  } else {\n    const styles = allDisplayNames.map(displayName => theme.componentStyles[displayName]).filter(Boolean);\n\n    if (styles.length > 0) {\n      mergedStyles = styles.reduce<ComponentSlotStylesPrepared>((acc, styles) => {\n        return mergeComponentStyles(acc, styles);\n      }, {});\n    } else {\n      mergedStyles = { root: () => ({}) };\n    }\n  }\n\n  if (!noInlineStylesOverrides) {\n    mergedStyles = mergeComponentStyles(\n      mergedStyles,\n      mergeComponentStyles(\n        design && withDebugId({ root: design } as ComponentSlotStylesInput, 'props.design'),\n        styles && withDebugId({ root: styles } as ComponentSlotStylesInput, 'props.styles'),\n      ),\n    );\n  }\n\n  const styleParam: ComponentStyleFunctionParam = {\n    props: componentProps,\n    variables: resolvedVariables,\n    theme,\n    rtl,\n    disableAnimations,\n  };\n\n  // Heads Up! Keep in sync with Design.tsx render logic\n  const rendererParam: RendererParam = {\n    direction: rtl ? 'rtl' : 'ltr',\n    disableAnimations,\n    displayName: allDisplayNames.join(':'), // does not affect styles, only used by useEnhancedRenderer in docs\n    sanitizeCss: performanceFlags.enableSanitizeCssPlugin,\n  };\n\n  const resolvedStylesDebug: Record<string, { styles: Object }[]> = {};\n\n  if (cacheEnabled && theme) {\n    if (!stylesCache.has(theme)) {\n      stylesCache.set(theme, {});\n    }\n    if (!classesCache.has(theme)) {\n      classesCache.set(theme, {});\n    }\n  }\n\n  const propsCacheKey = cacheEnabled ? JSON.stringify(componentProps) : '';\n  const variablesCacheKey =\n    cacheEnabled && performanceFlags.enableBooleanVariablesCaching ? JSON.stringify(variables) : '';\n  const componentCacheKey = cacheEnabled\n    ? `${allDisplayNames.join(':')}:${propsCacheKey}:${variablesCacheKey}:${styleParam.rtl}${\n        styleParam.disableAnimations\n      }`\n    : '';\n\n  if (typeof Proxy === 'undefined') {\n    //\n    //\n    // IE11 branch of code, feel free to remove later.\n    // Keep it sync with another branch below!\n    //\n    //\n\n    const resolvedStyles: Record<string, ICSSInJSStyle> = {};\n    const classes: Record<string, string> = {};\n\n    Object.keys(mergedStyles).forEach(slotName => {\n      // resolve/render slot styles once and cache\n      const lazyEvaluationKey = `${slotName}__return`;\n      const slotCacheKey = componentCacheKey + slotName;\n\n      Object.defineProperty(resolvedStyles, slotName, {\n        enumerable: false,\n        configurable: false,\n        set(val: ICSSInJSStyle) {\n          // Add to the cache if it's enabled\n          if (cacheEnabled && theme) {\n            stylesCache.set(theme, {\n              ...stylesCache.get(theme),\n              [slotCacheKey]: val,\n            });\n          }\n\n          resolvedStyles[lazyEvaluationKey] = val;\n        },\n        get(): ICSSInJSStyle {\n          // If caching enabled and entry exists, get from cache, avoid lazy evaluation\n          if (cacheEnabled && theme) {\n            const stylesThemeCache = stylesCache.get(theme) || {};\n            if (stylesThemeCache[slotCacheKey]) {\n              return stylesThemeCache[slotCacheKey];\n            }\n          }\n\n          if (resolvedStyles[lazyEvaluationKey]) {\n            return resolvedStyles[lazyEvaluationKey];\n          }\n\n          const telemetryPartStart = telemetry?.enabled ? performance.now() : 0;\n\n          // resolve/render slot styles once and cache\n          resolvedStyles[lazyEvaluationKey] = mergedStyles[slotName](styleParam);\n\n          if (cacheEnabled && theme) {\n            stylesCache.set(theme, {\n              ...stylesCache.get(theme),\n              [slotCacheKey]: resolvedStyles[lazyEvaluationKey],\n            });\n          }\n\n          if (process.env.NODE_ENV !== 'production' && isDebugEnabled) {\n            resolvedStylesDebug[slotName] = (resolvedStyles[slotName] as any)?.['_debug'];\n            delete (resolvedStyles[slotName] as any)?.['_debug'];\n          }\n\n          if (telemetry?.enabled && telemetry.performance[primaryDisplayName]) {\n            telemetry.performance[primaryDisplayName].msResolveStylesTotal += performance.now() - telemetryPartStart;\n          }\n\n          return resolvedStyles[lazyEvaluationKey];\n        },\n      });\n\n      Object.defineProperty(classes, slotName, {\n        enumerable: false,\n        configurable: false,\n        set(val: string) {\n          if (cacheEnabled && theme) {\n            classesCache.set(theme, {\n              ...classesCache.get(theme),\n              [slotCacheKey]: val,\n            });\n          }\n\n          classes[lazyEvaluationKey] = val;\n        },\n        get(): string {\n          if (cacheEnabled && theme) {\n            const classesThemeCache = classesCache.get(theme) || {};\n\n            //\n            // Cached styles\n            //\n\n            if (classesThemeCache[slotCacheKey] || classesThemeCache[slotCacheKey] === '') {\n              if (telemetry?.performance[primaryDisplayName]) {\n                if (slotName === 'root') {\n                  telemetry.performance[primaryDisplayName].stylesRootCacheHits++;\n                } else {\n                  telemetry.performance[primaryDisplayName].stylesSlotsCacheHits++;\n                }\n              }\n\n              return slotName === 'root'\n                ? cx(componentClassName, classesThemeCache[slotCacheKey], className)\n                : classesThemeCache[slotCacheKey];\n            }\n          }\n\n          //\n          // Lazy eval\n          //\n\n          if (classes[lazyEvaluationKey]) {\n            return slotName === 'root'\n              ? cx(componentClassName, classes[lazyEvaluationKey], className)\n              : classes[lazyEvaluationKey];\n          }\n\n          // this resolves the getter magic\n          const styleObj = resolvedStyles[slotName];\n          const telemetryPartStart = telemetry?.enabled ? performance.now() : 0;\n\n          if (styleObj) {\n            classes[lazyEvaluationKey] = renderer.renderRule(styleObj, rendererParam);\n\n            if (cacheEnabled && theme) {\n              classesCache.set(theme, {\n                ...classesCache.get(theme),\n                [slotCacheKey]: classes[lazyEvaluationKey],\n              });\n            }\n          }\n\n          const resultClassName =\n            slotName === 'root'\n              ? cx(componentClassName, classes[lazyEvaluationKey], className)\n              : classes[lazyEvaluationKey];\n\n          if (telemetry?.enabled && telemetry.performance[primaryDisplayName]) {\n            telemetry.performance[primaryDisplayName].msRenderStylesTotal += performance.now() - telemetryPartStart;\n          }\n\n          return resultClassName;\n        },\n      });\n    });\n\n    return {\n      resolvedStyles,\n      resolvedStylesDebug,\n      classes,\n    };\n  }\n\n  const resolvedStyles = new Proxy<Record<string, ICSSInJSStyle>>(\n    {},\n    {\n      get(target, slotName: string) {\n        const slotCacheKey = componentCacheKey + slotName;\n\n        // If caching enabled and entry exists, get from cache, avoid lazy evaluation\n        if (cacheEnabled && theme) {\n          const stylesThemeCache = stylesCache.get(theme) || {};\n          if (stylesThemeCache[slotCacheKey]) {\n            return stylesThemeCache[slotCacheKey];\n          }\n        }\n\n        if (target[slotName]) {\n          return target[slotName];\n        }\n\n        const telemetryPartStart = telemetry?.enabled ? performance.now() : 0;\n\n        // resolve/render slot styles once and cache\n        target[slotName] = mergedStyles[slotName]?.(styleParam);\n\n        if (cacheEnabled && theme) {\n          stylesCache.set(theme, {\n            ...stylesCache.get(theme),\n            [slotCacheKey]: target[slotName],\n          });\n        }\n\n        if (process.env.NODE_ENV !== 'production' && isDebugEnabled) {\n          resolvedStylesDebug[slotName] = (target[slotName] as any)?.['_debug'];\n          delete (target[slotName] as any)?.['_debug'];\n        }\n\n        if (telemetry?.enabled && telemetry.performance[primaryDisplayName]) {\n          telemetry.performance[primaryDisplayName].msResolveStylesTotal += performance.now() - telemetryPartStart;\n        }\n\n        return target[slotName];\n      },\n    },\n  );\n  const classes = new Proxy<Record<string, string>>(\n    {},\n    {\n      get(target, slotName: string) {\n        const slotCacheKey = componentCacheKey + slotName;\n\n        if (cacheEnabled && theme) {\n          const classesThemeCache = classesCache.get(theme) || {};\n\n          //\n          // Cached styles\n          //\n\n          if (classesThemeCache[slotCacheKey] || classesThemeCache[slotCacheKey] === '') {\n            if (telemetry?.performance[primaryDisplayName]) {\n              if (slotName === 'root') {\n                telemetry.performance[primaryDisplayName].stylesRootCacheHits++;\n              } else {\n                telemetry.performance[primaryDisplayName].stylesSlotsCacheHits++;\n              }\n            }\n\n            return slotName === 'root'\n              ? cx(componentClassName, classesThemeCache[slotCacheKey], className)\n              : classesThemeCache[slotCacheKey];\n          }\n        }\n\n        //\n        // Lazy eval\n        //\n\n        if (target[slotName]) {\n          return slotName === 'root' ? cx(componentClassName, target[slotName], className) : target[slotName];\n        }\n\n        // this resolves the getter magic\n        const styleObj = resolvedStyles[slotName];\n        const telemetryPartStart = telemetry?.enabled ? performance.now() : 0;\n\n        if (styleObj) {\n          target[slotName] = renderer.renderRule(styleObj, rendererParam);\n\n          if (cacheEnabled && theme) {\n            classesCache.set(theme, {\n              ...classesCache.get(theme),\n              [slotCacheKey]: target[slotName],\n            });\n          }\n        }\n\n        const resultClassName =\n          slotName === 'root' ? cx(componentClassName, target[slotName], className) : target[slotName];\n\n        if (telemetry?.enabled && telemetry.performance[primaryDisplayName]) {\n          telemetry.performance[primaryDisplayName].msRenderStylesTotal += performance.now() - telemetryPartStart;\n        }\n\n        return resultClassName;\n      },\n    },\n  );\n\n  return {\n    resolvedStyles,\n    resolvedStylesDebug,\n    classes,\n  };\n};\n"],"mappings":"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"}