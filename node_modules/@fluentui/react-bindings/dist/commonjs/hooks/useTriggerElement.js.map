{"version":3,"file":"useTriggerElement.js","names":["_reactComponentRef","require","React","_interopRequireWildcard","ReactIs","_childrenExist","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","isDisabledInteractive","node","nodeName","disabled","isInteractiveFilter","NodeFilter","FILTER_ACCEPT","FILTER_SKIP","useTriggerElement","props","trigger","childrenExist","children","element","Children","only","process","env","NODE_ENV","isFragment","Error","ref","useRef","useEffect","current","_ref$current$ownerDoc","console","warn","join","treeWalker","ownerDocument","createTreeWalker","SHOW_ELEMENT","acceptNode","nextNode","_node$ownerDocument","_node$ownerDocument$d","currentNode","nodeStyles","defaultView","getComputedStyle","pointerEvents","createElement","Ref","_extends2","innerRef"],"sources":["hooks/useTriggerElement.tsx"],"sourcesContent":["import { Ref } from '@fluentui/react-component-ref';\nimport * as React from 'react';\nimport * as ReactIs from 'react-is';\n\nimport { childrenExist } from '../utils/childrenExist';\n\ntype UseTriggerElementOptions = {\n  children?: React.ReactNode;\n  trigger?: React.ReactElement;\n};\n\n// https://github.com/facebook/react/blob/c4e0768d7487a9359b74986e3b07841d2520f593/packages/react-dom/src/events/getListener.js#L15-L22\nfunction isDisabledInteractive(node: Node): boolean {\n  return (\n    (node.nodeName === 'BUTTON' ||\n      node.nodeName === 'INPUT' ||\n      node.nodeName === 'SELECT' ||\n      node.nodeName === 'TEXTAREA') &&\n    (node as HTMLButtonElement).disabled\n  );\n}\n\nfunction isInteractiveFilter(node: Node) {\n  return isDisabledInteractive(node) ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_SKIP;\n}\n\n/**\n * Performs consistent checks for components that are using `trigger` pattern (`Tooltip`, `Popup`). Ensures that\n * `children` or `trigger` props will always pass a valid React element to what additional props and handlers can\n * be applied.\n */\nexport function useTriggerElement(props: UseTriggerElementOptions): React.ReactElement | null {\n  const trigger = childrenExist(props.children) ? props.children : props.trigger;\n  const element = trigger ? (React.Children.only(trigger) as React.ReactElement) : null;\n\n  // An exception should not be thrown in tests as components might be rendered without styles\n  if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {\n    if (ReactIs.isFragment(element)) {\n      throw new Error(\n        'useTriggerElement(): A \"React.Fragment\" cannot be used as a \"trigger\" as it will be impossible to spread props on it',\n      );\n    }\n\n    // Hooks are used only for dev mode validations and will be removed in production builds\n    /* eslint-disable react-hooks/rules-of-hooks */\n\n    const ref = React.useRef<HTMLElement>() as React.RefObject<HTMLElement | HTMLButtonElement>;\n\n    React.useEffect(() => {\n      if (ref.current) {\n        if (isDisabledInteractive(ref.current)) {\n          // eslint-disable-next-line no-console\n          console.warn(\n            [\n              'useTriggerElement(): Disabled elements should used as a \"trigger\" accurately as it may lead to ',\n              'unexpected behavior as pointer events are ignored on disabled elements. Please wrap your \"trigger\" with',\n              'an additional element like a \"div\" if you need to show tooltips or popups on disabled elements, an',\n              'example is available in docs:',\n              'https://fluentsite.z22.web.core.windows.net/components/tooltip/definition#usage-disabled-trigger',\n            ].join(' '),\n          );\n        }\n\n        const treeWalker = ref.current.ownerDocument?.createTreeWalker(ref.current, NodeFilter.SHOW_ELEMENT, {\n          acceptNode: isInteractiveFilter,\n        });\n        while (treeWalker?.nextNode()) {\n          const node = treeWalker.currentNode;\n          const nodeStyles = node.ownerDocument?.defaultView?.getComputedStyle(node as Element);\n\n          if (nodeStyles?.pointerEvents !== 'none') {\n            throw new Error(\n              [\n                'useTriggerElement(): A disabled element should have explicit \"pointer-events: \"none\" in its styles',\n                'due a bug in Chrome that breaks \"onMouseLeave\" event in React:',\n                'https://github.com/facebook/react/issues/19692',\n              ].join(' '),\n            );\n          }\n        }\n      }\n    }, []);\n\n    return element ? (\n      /* Required as components may call handlers via `trigger.props`, Ref will pass unhandled props down */\n      <Ref {...(element as React.ReactElement).props} innerRef={ref}>\n        {element}\n      </Ref>\n    ) : null;\n  }\n\n  return element;\n}\n"],"mappings":"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"}