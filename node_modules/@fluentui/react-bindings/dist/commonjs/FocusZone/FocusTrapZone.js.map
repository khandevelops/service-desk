{"version":3,"file":"FocusTrapZone.js","names":["_reactComponentEventListener","require","React","_interopRequireWildcard","ReactDOM","PropTypes","_getElementType","_getUnhandledProps","_focusUtilities","_reactComponentRef","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","FocusTrapZone","_React$Component","_inheritsLoose2","_this","_len","arguments","length","args","Array","_key","apply","concat","_root","current","_previouslyFocusedElementOutsideTrapZone","_previouslyFocusedElementInTrapZone","_firstBumper","createRef","_lastBumper","_hasFocus","windowRef","elem","findDOMNode","getWindow","shouldHandleOutsideClick","props","isClickableOutsideFocusTrap","focusTriggerOnOutsideClick","handleRef","element","innerRef","_onRootFocus","ev","onFocus","_onRootBlur","onBlur","relatedTarget","doc","getDocument","activeElement","contains","_onFirstBumperFocus","_onBumperFocus","_onLastBumperFocus","isFirstBumper","currentBumper","nextFocusable","getLastTabbable","getFirstTabbable","_isBumper","_findElementAndFocusAsync","focus","_enableFocusTrapZone","_this$props$disabled","disabled","_focusStack","push","_assertThisInitialized2","_bringFocusIntoZone","_hideContentFromAccessibilityTree","_this$props$disableFi","disableFirstFocus","_getPreviouslyFocusedElementOutsideTrapZone","_releaseFocusTrapZone","ignoreExternalFocusing","filter","value","body","_focusAsync","preventScroll","preventScrollOnRestoreFocus","lastActiveFocusTrap","_showContentInAccessibilityTree","parentElement","removeAttribute","HIDDEN_FROM_ACC_TREE","_this$props","focusPreviouslyFocusedInnerElement","firstFocusableSelector","focusSelector","firstFocusableChild","querySelector","getNextElement","firstChild","_onFocusCapture","onFocusCapture","target","currentTarget","_forceFocusInTrap","triggeredElement","preventDefault","stopPropagation","_handleOutsideFocus","focusedElement","_handleOutsideClick","clickedElement","_this$props2","isOutsideFocusTrapZone","isOutsideTriggerElement","_onKeyboardHandler","onKeyDown","elementToFocusOnDismiss","previouslyFocusedElement","bodyChildren","children","console","warn","index","currentChild","isOrHasFocusTrapZone","isAriaLiveRegion","hasAttribute","getAttribute","setAttribute","hiddenElements","querySelectorAll","_proto","componentDidMount","componentDidUpdate","prevProps","_this$props3","forceFocusInsideTrapOnComponentUpdate","forceFocusInsideTrapOnOutsideFocus","prevForceFocusInsideTrap","undefined","newForceFocusInsideTrap","prevDisabled","newDisabled","componentWillUnmount","render","_this$props4","className","ariaLabelledBy","_this$props4$disabled","unhandledProps","getUnhandledProps","_keys2","propTypes","ElementType","getElementType","bumperProps","style","pointerEvents","position","tabIndex","createElement","Fragment","_extends2","ref","EventListener","capture","listener","targetRef","type","options","focusAsync","Component","exports","as","elementType","string","object","bool","any","defaultProps"],"sources":["FocusZone/FocusTrapZone.tsx"],"sourcesContent":["import { EventListener } from '@fluentui/react-component-event-listener';\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport * as PropTypes from 'prop-types';\nimport * as _ from 'lodash';\n\nimport { getElementType } from '../utils/getElementType';\nimport { getUnhandledProps } from '../utils/getUnhandledProps';\nimport {\n  getNextElement,\n  getFirstTabbable,\n  getLastTabbable,\n  getWindow,\n  getDocument,\n  focusAsync,\n  HIDDEN_FROM_ACC_TREE,\n} from './focusUtilities';\nimport { FocusTrapZoneProps } from './FocusTrapZone.types';\nimport { handleRef } from '@fluentui/react-component-ref';\n\n/** FocusTrapZone is used to trap the focus in any html element placed in body\n *  and hide other elements outside of Focus Trap Zone from accessibility tree.\n *  Pressing tab will circle focus within the inner focusable elements of the FocusTrapZone. */\nexport class FocusTrapZone extends React.Component<FocusTrapZoneProps, {}> {\n  static _focusStack: FocusTrapZone[] = [];\n\n  _root: { current: HTMLElement | null } = { current: null };\n\n  _previouslyFocusedElementOutsideTrapZone?: HTMLElement;\n  _previouslyFocusedElementInTrapZone?: HTMLElement;\n\n  _firstBumper = React.createRef<HTMLDivElement>();\n  _lastBumper = React.createRef<HTMLDivElement>();\n  _hasFocus: boolean = false;\n\n  windowRef = React.createRef<Window>() as React.MutableRefObject<Window>;\n\n  // @ts-ignore\n  createRef = elem => {\n    this._root.current = ReactDOM.findDOMNode(elem) as HTMLElement;\n    // @ts-ignore\n    this.windowRef.current = getWindow(this._root.current);\n  };\n\n  shouldHandleOutsideClick = () => !this.props.isClickableOutsideFocusTrap || !this.props.focusTriggerOnOutsideClick;\n\n  static propTypes = {\n    as: PropTypes.elementType,\n    className: PropTypes.string,\n    elementToFocusOnDismiss: PropTypes.object,\n    ariaLabelledBy: PropTypes.string,\n    isClickableOutsideFocusTrap: PropTypes.bool,\n    ignoreExternalFocusing: PropTypes.bool,\n    forceFocusInsideTrapOnOutsideFocus: PropTypes.bool,\n    forceFocusInsideTrapOnComponentUpdate: PropTypes.bool,\n    firstFocusableSelector: PropTypes.string,\n    disableFirstFocus: PropTypes.bool,\n    focusPreviouslyFocusedInnerElement: PropTypes.bool,\n    focusTriggerOnOutsideClick: PropTypes.bool,\n    preventScrollOnRestoreFocus: PropTypes.bool,\n    innerRef: PropTypes.any,\n  };\n\n  static defaultProps: FocusTrapZoneProps = {\n    as: 'div',\n    isClickableOutsideFocusTrap: true,\n    forceFocusInsideTrapOnOutsideFocus: false,\n  };\n\n  componentDidMount(): void {\n    this._enableFocusTrapZone();\n  }\n\n  componentDidUpdate(prevProps: FocusTrapZoneProps): void {\n    const { forceFocusInsideTrapOnComponentUpdate, forceFocusInsideTrapOnOutsideFocus, disabled } = this.props;\n    const doc = getDocument(this._root.current);\n    // @ts-ignore\n    const activeElement = doc.activeElement as HTMLElement;\n\n    // if after componentDidUpdate focus is not inside the focus trap, bring it back\n    if (\n      !disabled &&\n      // @ts-ignore\n      !this._root.current.contains(activeElement) &&\n      forceFocusInsideTrapOnComponentUpdate\n    ) {\n      this._bringFocusIntoZone();\n      return;\n    }\n\n    const prevForceFocusInsideTrap =\n      prevProps.forceFocusInsideTrapOnOutsideFocus !== undefined ? prevProps.forceFocusInsideTrapOnOutsideFocus : true;\n    const newForceFocusInsideTrap =\n      forceFocusInsideTrapOnOutsideFocus !== undefined ? forceFocusInsideTrapOnOutsideFocus : true;\n    const prevDisabled = prevProps.disabled !== undefined ? prevProps.disabled : false;\n    const newDisabled = disabled !== undefined ? disabled : false;\n\n    if ((!prevForceFocusInsideTrap && newForceFocusInsideTrap) || (prevDisabled && !newDisabled)) {\n      // Transition from forceFocusInsideTrap / FTZ disabled to enabled.\n      // Emulate what happens when a FocusTrapZone gets mounted.\n      this._enableFocusTrapZone();\n    } else if ((prevForceFocusInsideTrap && !newForceFocusInsideTrap) || (!prevDisabled && newDisabled)) {\n      // Transition from forceFocusInsideTrap / FTZ enabled to disabled.\n      // Emulate what happens when a FocusTrapZone gets unmounted.\n      this._releaseFocusTrapZone();\n    }\n  }\n\n  componentWillUnmount(): void {\n    // don't handle return focus unless forceFocusInsideTrapOnOutsideFocus is true or focus is still within FocusTrapZone\n    const doc = getDocument(this._root.current);\n    if (\n      !this.props.disabled ||\n      this.props.forceFocusInsideTrapOnOutsideFocus ||\n      // @ts-ignore\n      !this._root.current.contains(doc.activeElement as HTMLElement)\n    ) {\n      this._releaseFocusTrapZone();\n    }\n\n    // Dispose of element references so the DOM Nodes can be garbage-collected\n    delete this._previouslyFocusedElementInTrapZone;\n    delete this._previouslyFocusedElementOutsideTrapZone;\n  }\n\n  handleRef = (element: HTMLElement) => {\n    this.createRef(element);\n    handleRef(this.props.innerRef, element);\n  };\n\n  render(): JSX.Element {\n    const { className, forceFocusInsideTrapOnOutsideFocus, ariaLabelledBy, disabled = false } = this.props;\n    const unhandledProps = getUnhandledProps(_.keys(FocusTrapZone.propTypes) as any, this.props);\n    const ElementType = getElementType(this.props);\n\n    const bumperProps = {\n      'aria-hidden': true,\n      style: {\n        pointerEvents: 'none',\n        position: 'fixed', // 'fixed' prevents browsers from scrolling to bumpers when viewport does not contain them\n      },\n      tabIndex: disabled ? -1 : 0, // make bumpers tabbable only when enabled\n      'data-is-visible': true,\n    } as React.HTMLAttributes<HTMLDivElement>;\n\n    return (\n      <>\n        <ElementType\n          {...unhandledProps}\n          className={className}\n          ref={this.handleRef}\n          aria-labelledby={ariaLabelledBy}\n          onKeyDown={this._onKeyboardHandler}\n          onFocusCapture={this._onFocusCapture}\n          onFocus={this._onRootFocus}\n          onBlur={this._onRootBlur}\n        >\n          <div {...bumperProps} ref={this._firstBumper} onFocus={this._onFirstBumperFocus} />\n          {this.props.children}\n          <div {...bumperProps} ref={this._lastBumper} onFocus={this._onLastBumperFocus} />\n        </ElementType>\n\n        {forceFocusInsideTrapOnOutsideFocus && (\n          <EventListener capture listener={this._handleOutsideFocus} targetRef={this.windowRef} type=\"focus\" />\n        )}\n        {this.shouldHandleOutsideClick() && (\n          <EventListener capture listener={this._handleOutsideClick} targetRef={this.windowRef} type=\"click\" />\n        )}\n      </>\n    );\n  }\n\n  _onRootFocus = (ev: React.FocusEvent<HTMLDivElement>) => {\n    if (this.props.onFocus) {\n      this.props.onFocus(ev);\n    }\n\n    this._hasFocus = true;\n  };\n\n  _onRootBlur = (ev: React.FocusEvent<HTMLDivElement>) => {\n    if (this.props.onBlur) {\n      this.props.onBlur(ev);\n    }\n\n    let relatedTarget = ev.relatedTarget;\n    if (ev.relatedTarget === null) {\n      // In IE11, due to lack of support, event.relatedTarget is always\n      // null making every onBlur call to be \"outside\" of the ComboBox\n      // even when it's not. Using document.activeElement is another way\n      // for us to be able to get what the relatedTarget without relying\n      // on the event\n      const doc = getDocument(this._root.current);\n      // @ts-ignore\n      relatedTarget = doc.activeElement as Element;\n    }\n\n    // @ts-ignore\n    if (!this._root.current.contains(relatedTarget as HTMLElement)) {\n      this._hasFocus = false;\n    }\n  };\n\n  _onFirstBumperFocus = () => {\n    this._onBumperFocus(true);\n  };\n\n  _onLastBumperFocus = () => {\n    this._onBumperFocus(false);\n  };\n\n  _isBumper(element: HTMLElement): boolean {\n    return element === this._firstBumper.current || element === this._lastBumper.current;\n  }\n\n  _onBumperFocus = (isFirstBumper: boolean) => {\n    if (!this._root.current) {\n      return;\n    }\n\n    const currentBumper = (\n      isFirstBumper === this._hasFocus ? this._lastBumper.current : this._firstBumper.current\n    ) as HTMLElement;\n\n    const nextFocusable =\n      isFirstBumper === this._hasFocus\n        ? getLastTabbable(this._root.current, currentBumper, true, false)\n        : getFirstTabbable(this._root.current, currentBumper, true, false);\n\n    if (nextFocusable) {\n      if (this._isBumper(nextFocusable)) {\n        // This can happen when FTZ contains no tabbable elements. Focus will take care of finding a focusable element in FTZ.\n        this._findElementAndFocusAsync();\n      } else {\n        nextFocusable.focus();\n      }\n    }\n  };\n\n  _focusAsync(element: HTMLElement, options?: FocusOptions): void {\n    if (!this._isBumper(element)) {\n      focusAsync(element, options);\n    }\n  }\n\n  _enableFocusTrapZone = () => {\n    const { disabled = false } = this.props;\n    if (disabled) {\n      return;\n    }\n\n    FocusTrapZone._focusStack.push(this);\n\n    this._bringFocusIntoZone();\n    this._hideContentFromAccessibilityTree();\n  };\n\n  _bringFocusIntoZone = () => {\n    const { disableFirstFocus = false } = this.props;\n\n    this._previouslyFocusedElementOutsideTrapZone = this._getPreviouslyFocusedElementOutsideTrapZone();\n\n    if (\n      // @ts-ignore\n      !this._root.current.contains(this._previouslyFocusedElementOutsideTrapZone) &&\n      !disableFirstFocus\n    ) {\n      this._findElementAndFocusAsync();\n    }\n  };\n\n  _releaseFocusTrapZone = () => {\n    const { ignoreExternalFocusing } = this.props;\n\n    FocusTrapZone._focusStack = FocusTrapZone._focusStack.filter((value: FocusTrapZone) => {\n      return this !== value;\n    });\n\n    // try to focus element which triggered FocusTrapZone - prviously focused element outside trap zone\n    const doc = getDocument(this._root.current);\n    // @ts-ignore\n    const activeElement = doc.activeElement as HTMLElement;\n    if (\n      !ignoreExternalFocusing &&\n      this._previouslyFocusedElementOutsideTrapZone &&\n      // @ts-ignore\n      (this._root.current.contains(activeElement) || activeElement === doc.body)\n    ) {\n      this._focusAsync(this._previouslyFocusedElementOutsideTrapZone, {\n        preventScroll: this.props.preventScrollOnRestoreFocus,\n      });\n    }\n\n    // if last active focus trap zone is going to be released - show previously hidden content in accessibility tree\n    const lastActiveFocusTrap =\n      FocusTrapZone._focusStack.length && FocusTrapZone._focusStack[FocusTrapZone._focusStack.length - 1];\n\n    if (!lastActiveFocusTrap) {\n      this._showContentInAccessibilityTree();\n    } else if (lastActiveFocusTrap._root.current) {\n      let element = lastActiveFocusTrap._root.current;\n      // aria hidden attributes are added to direct children of body. It can be the focusTrapZone root itself, or its parent\n      while (element.parentElement && element.parentElement !== doc?.body) {\n        element = element.parentElement;\n      }\n      element.removeAttribute(HIDDEN_FROM_ACC_TREE);\n      element.removeAttribute('aria-hidden');\n    }\n  };\n\n  _findElementAndFocusAsync = () => {\n    if (!this._root.current) {\n      return;\n    }\n\n    const { focusPreviouslyFocusedInnerElement, firstFocusableSelector } = this.props;\n\n    if (\n      focusPreviouslyFocusedInnerElement &&\n      this._previouslyFocusedElementInTrapZone &&\n      this._root.current.contains(this._previouslyFocusedElementInTrapZone)\n    ) {\n      // focus on the last item that had focus in the zone before we left the zone\n      this._focusAsync(this._previouslyFocusedElementInTrapZone);\n      return;\n    }\n\n    const focusSelector =\n      firstFocusableSelector &&\n      (typeof firstFocusableSelector === 'string' ? firstFocusableSelector : firstFocusableSelector());\n\n    let firstFocusableChild: HTMLElement | null = null;\n\n    if (focusSelector) {\n      firstFocusableChild = this._root.current.querySelector(focusSelector);\n    }\n\n    // Fall back to first element if query selector did not match any elements.\n    if (!firstFocusableChild) {\n      firstFocusableChild = getNextElement(\n        this._root.current,\n        this._root.current.firstChild as HTMLElement,\n        false,\n        false,\n        false,\n        true,\n      );\n    }\n\n    firstFocusableChild && this._focusAsync(firstFocusableChild);\n  };\n\n  _onFocusCapture = (ev: React.FocusEvent<HTMLDivElement>) => {\n    this.props.onFocusCapture && this.props.onFocusCapture(ev);\n    if (ev.target !== ev.currentTarget && !this._isBumper(ev.target)) {\n      // every time focus changes within the trap zone, remember the focused element so that\n      // it can be restored if focus leaves the pane and returns via keystroke (i.e. via a call to this.focus(true))\n      this._previouslyFocusedElementInTrapZone = ev.target as HTMLElement;\n    }\n  };\n\n  _forceFocusInTrap = (ev: Event, triggeredElement: HTMLElement) => {\n    if (FocusTrapZone._focusStack.length && this === FocusTrapZone._focusStack[FocusTrapZone._focusStack.length - 1]) {\n      // @ts-ignore\n      if (!this._root.current.contains(triggeredElement)) {\n        this._findElementAndFocusAsync();\n        ev.preventDefault();\n        ev.stopPropagation();\n      }\n    }\n  };\n\n  _handleOutsideFocus = (ev: FocusEvent): void => {\n    const doc = getDocument(this._root.current);\n    // @ts-ignore\n    const focusedElement = doc.activeElement as HTMLElement;\n    focusedElement && this._forceFocusInTrap(ev, focusedElement);\n  };\n\n  _handleOutsideClick = (ev: MouseEvent): void => {\n    const clickedElement = ev.target as HTMLElement;\n    const { isClickableOutsideFocusTrap, focusTriggerOnOutsideClick } = this.props;\n\n    if (!isClickableOutsideFocusTrap) {\n      clickedElement && this._forceFocusInTrap(ev, clickedElement);\n    } else if (!focusTriggerOnOutsideClick) {\n      const isOutsideFocusTrapZone = this._root.current && !this._root.current.contains(clickedElement);\n      const isOutsideTriggerElement =\n        this._previouslyFocusedElementOutsideTrapZone &&\n        !this._previouslyFocusedElementOutsideTrapZone.contains(clickedElement);\n      if (isOutsideFocusTrapZone && isOutsideTriggerElement) {\n        // set it to NULL, so the trigger will not be focused on componentWillUnmount\n        // @ts-ignore\n        this._previouslyFocusedElementOutsideTrapZone = null;\n      }\n    }\n  };\n\n  _onKeyboardHandler = (ev: React.KeyboardEvent<HTMLDivElement>): void => {\n    if (this.props.onKeyDown) {\n      this.props.onKeyDown(ev);\n    }\n\n    // do not propogate keyboard events outside focus trap zone\n    // https://github.com/microsoft/fluent-ui-react/pull/1180\n    ev.stopPropagation();\n  };\n\n  _getPreviouslyFocusedElementOutsideTrapZone = () => {\n    const { elementToFocusOnDismiss } = this.props;\n    let previouslyFocusedElement = this._previouslyFocusedElementOutsideTrapZone;\n\n    if (elementToFocusOnDismiss && previouslyFocusedElement !== elementToFocusOnDismiss) {\n      previouslyFocusedElement = elementToFocusOnDismiss;\n    } else if (!previouslyFocusedElement) {\n      const doc = getDocument(this._root.current);\n      // @ts-ignore\n      previouslyFocusedElement = doc.activeElement as HTMLElement;\n    }\n\n    return previouslyFocusedElement;\n  };\n\n  _hideContentFromAccessibilityTree = () => {\n    const doc = getDocument(this._root.current);\n    // @ts-ignore\n    const bodyChildren = (doc.body && doc.body.children) || [];\n\n    // @ts-ignore\n    if (bodyChildren.length && !doc.body.contains(this._root.current)) {\n      // In case popup render options will change\n      /* eslint-disable-next-line no-console */\n      console.warn(\n        'Body element does not contain trap zone element. Please, ensure the trap zone element is placed inside body, so it will work properly.',\n      );\n    }\n\n    for (let index = 0; index < bodyChildren.length; index++) {\n      const currentChild = bodyChildren[index] as HTMLElement;\n      const isOrHasFocusTrapZone = currentChild === this._root.current || currentChild.contains(this._root.current);\n      const isAriaLiveRegion = currentChild.hasAttribute('aria-live');\n\n      if (!isOrHasFocusTrapZone && !isAriaLiveRegion && currentChild.getAttribute('aria-hidden') !== 'true') {\n        currentChild.setAttribute('aria-hidden', 'true');\n        currentChild.setAttribute(HIDDEN_FROM_ACC_TREE, 'true');\n      }\n    }\n  };\n\n  _showContentInAccessibilityTree = () => {\n    const doc = getDocument(this._root.current);\n    // @ts-ignore\n    const hiddenElements = doc.querySelectorAll(`[${HIDDEN_FROM_ACC_TREE}=\"true\"]`);\n    for (let index = 0; index < hiddenElements.length; index++) {\n      const element = hiddenElements[index];\n      element.removeAttribute('aria-hidden');\n      element.removeAttribute(HIDDEN_FROM_ACC_TREE);\n    }\n  };\n}\n"],"mappings":"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"}