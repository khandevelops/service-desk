{"version":3,"file":"RendererProvider.js","names":["render","rehydrate","React","hasDOM","renderer","targetDocument","document","doc","createElement","hasServerRenderedStyle","querySelectorAll","length","RendererProvider","_React$Component","_inheritsLoose","props","_this","call","_renderStyle","_proto","prototype","componentDidUpdate","prevProps","_this$props","shouldRehydrate","Fragment","children","Component"],"sources":["RendererProvider.tsx"],"sourcesContent":["import { render, rehydrate } from 'fela-dom';\nimport * as React from 'react';\n\nimport { FelaRenderer } from './types';\n\n// Copied from https://github.com/robinweser/fela/blob/master/packages/fela-bindings/src/RendererProviderFactory.js\n\nfunction hasDOM(renderer: FelaRenderer, targetDocument: Document | undefined) {\n  // ensure we're on a browser by using document since window is defined in e.g. React Native\n  // see https://github.com/robinweser/fela/issues/736\n  if (typeof document === 'undefined') {\n    return false;\n  }\n\n  const doc = targetDocument || document;\n\n  return renderer && doc && doc.createElement;\n}\n\nfunction hasServerRenderedStyle(targetDocument = document) {\n  return targetDocument.querySelectorAll('[data-fela-type]').length > 0;\n}\n\ntype RendererProviderProps = {\n  renderer: FelaRenderer;\n  rehydrate?: boolean;\n  targetDocument?: Document;\n};\n\n// Typings provided by \"fela\" package are outdated, this overrides provides proper definition\ndeclare module 'fela-dom' {\n  function render(renderer: FelaRenderer, targetDocument?: Document): void;\n  function rehydrate(renderer: FelaRenderer, targetDocument?: Document): void;\n}\n\nexport class RendererProvider extends React.Component<RendererProviderProps, Record<string, unknown>> {\n  constructor(props: RendererProviderProps) {\n    super(props);\n    this._renderStyle();\n  }\n\n  componentDidUpdate(prevProps: RendererProviderProps) {\n    if (prevProps.renderer !== this.props.renderer) {\n      // add warning that renderer is changed\n      this._renderStyle();\n    }\n  }\n\n  _renderStyle() {\n    const { renderer, rehydrate: shouldRehydrate, targetDocument } = this.props;\n\n    if (hasDOM(renderer, targetDocument)) {\n      if (shouldRehydrate && hasServerRenderedStyle(targetDocument)) {\n        rehydrate(renderer, targetDocument);\n      } else {\n        render(renderer, targetDocument);\n      }\n    }\n  }\n\n  render() {\n    return <>{this.props.children}</>;\n  }\n}\n"],"mappings":";AAAA,SAASA,MAAM,EAAEC,SAAS,QAAQ,UAAU;AAC5C,OAAO,KAAKC,KAAK,MAAM,OAAO;AAI9B;;AAEA,SAASC,MAAMA,CAACC,QAAsB,EAAEC,cAAoC,EAAE;EAC5E;EACA;EACA,IAAI,OAAOC,QAAQ,KAAK,WAAW,EAAE;IACnC,OAAO,KAAK;EACd;EAEA,IAAMC,GAAG,GAAGF,cAAc,IAAIC,QAAQ;EAEtC,OAAOF,QAAQ,IAAIG,GAAG,IAAIA,GAAG,CAACC,aAAa;AAC7C;AAEA,SAASC,sBAAsBA,CAACJ,cAAc,EAAa;EAAA,IAA3BA,cAAc;IAAdA,cAAc,GAAGC,QAAQ;EAAA;EACvD,OAAOD,cAAc,CAACK,gBAAgB,CAAC,kBAAkB,CAAC,CAACC,MAAM,GAAG,CAAC;AACvE;;AAQA;;AAMA,WAAaC,gBAAgB,0BAAAC,gBAAA;EAAAC,cAAA,CAAAF,gBAAA,EAAAC,gBAAA;EAC3B,SAAAD,iBAAYG,KAA4B,EAAE;IAAA,IAAAC,KAAA;IACxCA,KAAA,GAAAH,gBAAA,CAAAI,IAAA,OAAMF,KAAK,CAAC;IACZC,KAAA,CAAKE,YAAY,CAAC,CAAC;IAAC,OAAAF,KAAA;EACtB;EAAC,IAAAG,MAAA,GAAAP,gBAAA,CAAAQ,SAAA;EAAAD,MAAA,CAEDE,kBAAkB,GAAlB,SAAAA,mBAAmBC,SAAgC,EAAE;IACnD,IAAIA,SAAS,CAAClB,QAAQ,KAAK,IAAI,CAACW,KAAK,CAACX,QAAQ,EAAE;MAC9C;MACA,IAAI,CAACc,YAAY,CAAC,CAAC;IACrB;EACF,CAAC;EAAAC,MAAA,CAEDD,YAAY,GAAZ,SAAAA,aAAA,EAAe;IACb,IAAAK,WAAA,GAAiE,IAAI,CAACR,KAAK;MAAnEX,QAAQ,GAAAmB,WAAA,CAARnB,QAAQ;MAAaoB,eAAe,GAAAD,WAAA,CAA1BtB,SAAS;MAAmBI,cAAc,GAAAkB,WAAA,CAAdlB,cAAc;IAE5D,IAAIF,MAAM,CAACC,QAAQ,EAAEC,cAAc,CAAC,EAAE;MACpC,IAAImB,eAAe,IAAIf,sBAAsB,CAACJ,cAAc,CAAC,EAAE;QAC7DJ,SAAS,CAACG,QAAQ,EAAEC,cAAc,CAAC;MACrC,CAAC,MAAM;QACLL,MAAM,CAACI,QAAQ,EAAEC,cAAc,CAAC;MAClC;IACF;EACF,CAAC;EAAAc,MAAA,CAEDnB,MAAM,GAAN,SAAAA,OAAA,EAAS;IACP,oBAAOE,KAAA,CAAAM,aAAA,CAAAN,KAAA,CAAAuB,QAAA,QAAG,IAAI,CAACV,KAAK,CAACW,QAAW,CAAC;EACnC,CAAC;EAAA,OAAAd,gBAAA;AAAA,EA3BmCV,KAAK,CAACyB,SAAS"}