{"version":3,"file":"felaStylisEnhancer.js","names":["RULE_TYPE","_Stylis","Stylis","default","stylis","cascade","compress","global","keyframe","preserve","semicolon","felaStylisEnhancer","renderer","existingEmitChange","_emitChange","bind","change","type","prefixed","declaration","slice"],"sources":["felaStylisEnhancer.ts"],"sourcesContent":["import { RULE_TYPE } from 'fela-utils';\n// @ts-ignore\nimport _Stylis from 'stylis';\n\nimport { FelaRenderer, FelaRendererChange } from './types';\n\n// `stylis@3` is a CJS library, there are known issues with them:\n// https://github.com/rollup/rollup/issues/1267#issuecomment-446681320\nconst Stylis: typeof import('stylis') = (_Stylis as any).default || _Stylis;\n\n// We use Stylis only for vendor prefixing, all other capabilities are disabled\nconst stylis = new Stylis({\n  cascade: false,\n  compress: false,\n  global: false,\n  keyframe: false,\n  preserve: false,\n  semicolon: false,\n});\n\nexport const felaStylisEnhancer = (renderer: FelaRenderer) => {\n  const existingEmitChange = renderer._emitChange.bind(renderer);\n\n  renderer._emitChange = (change: FelaRendererChange) => {\n    if (change.type === RULE_TYPE) {\n      const prefixed: string = stylis('', change.declaration);\n\n      // Fela uses objects by references, it's safe to override properties\n      change.declaration = prefixed.slice(1, -1);\n    }\n\n    existingEmitChange(change);\n  };\n\n  return renderer;\n};\n"],"mappings":"AAAA,SAASA,SAAS,QAAQ,YAAY;AACtC;AACA,OAAOC,OAAO,MAAM,QAAQ;AAI5B;AACA;AACA,IAAMC,MAA+B,GAAID,OAAO,CAASE,OAAO,IAAIF,OAAO;;AAE3E;AACA,IAAMG,MAAM,GAAG,IAAIF,MAAM,CAAC;EACxBG,OAAO,EAAE,KAAK;EACdC,QAAQ,EAAE,KAAK;EACfC,MAAM,EAAE,KAAK;EACbC,QAAQ,EAAE,KAAK;EACfC,QAAQ,EAAE,KAAK;EACfC,SAAS,EAAE;AACb,CAAC,CAAC;AAEF,OAAO,IAAMC,kBAAkB,GAAG,SAArBA,kBAAkBA,CAAIC,QAAsB,EAAK;EAC5D,IAAMC,kBAAkB,GAAGD,QAAQ,CAACE,WAAW,CAACC,IAAI,CAACH,QAAQ,CAAC;EAE9DA,QAAQ,CAACE,WAAW,GAAG,UAACE,MAA0B,EAAK;IACrD,IAAIA,MAAM,CAACC,IAAI,KAAKjB,SAAS,EAAE;MAC7B,IAAMkB,QAAgB,GAAGd,MAAM,CAAC,EAAE,EAAEY,MAAM,CAACG,WAAW,CAAC;;MAEvD;MACAH,MAAM,CAACG,WAAW,GAAGD,QAAQ,CAACE,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAC5C;IAEAP,kBAAkB,CAACG,MAAM,CAAC;EAC5B,CAAC;EAED,OAAOJ,QAAQ;AACjB,CAAC"}