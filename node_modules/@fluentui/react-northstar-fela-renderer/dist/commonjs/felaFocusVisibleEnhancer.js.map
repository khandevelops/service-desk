{"version":3,"file":"felaFocusVisibleEnhancer.js","names":["_felaUtils","require","felaFocusVisibleEnhancer","renderer","existingEmitChange","_emitChange","bind","change","type","RULE_TYPE","selector","indexOf","pseudo","replace","exports"],"sources":["felaFocusVisibleEnhancer.ts"],"sourcesContent":["import { RULE_TYPE } from 'fela-utils';\nimport { FelaRenderer, FelaRendererChange } from './types';\n\n/**\n * A Fela enhancer that allows to use `:focus-visible`. Uses `what-input` library and its global\n * selector. Modifies generated selectors:\n * `.a:focus-visible {}` => `html[data-whatinput=\"keyboard\"] a:focus`.\n */\nexport const felaFocusVisibleEnhancer = (renderer: FelaRenderer) => {\n  const existingEmitChange = renderer._emitChange.bind(renderer);\n\n  renderer._emitChange = (change: FelaRendererChange) => {\n    if (change.type === RULE_TYPE && change.selector.indexOf(':focus-visible') !== -1) {\n      // Fela uses objects by references, it's safe to override properties\n      change.pseudo = change.pseudo ? change.pseudo.replace(':focus-visible', ':focus') : '';\n      change.selector = `html[data-whatinput=\"keyboard\"] ${change.selector.replace(':focus-visible', ':focus')}`;\n    }\n\n    existingEmitChange(change);\n  };\n\n  return renderer;\n};\n"],"mappings":";;;;AAAA,IAAAA,UAAA,GAAAC,OAAA;AAGA;AACA;AACA;AACA;AACA;AACO,IAAMC,wBAAwB,GAAG,SAA3BA,wBAAwBA,CAAIC,QAAsB,EAAK;EAClE,IAAMC,kBAAkB,GAAGD,QAAQ,CAACE,WAAW,CAACC,IAAI,CAACH,QAAQ,CAAC;EAE9DA,QAAQ,CAACE,WAAW,GAAG,UAACE,MAA0B,EAAK;IACrD,IAAIA,MAAM,CAACC,IAAI,KAAKC,oBAAS,IAAIF,MAAM,CAACG,QAAQ,CAACC,OAAO,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,EAAE;MACjF;MACAJ,MAAM,CAACK,MAAM,GAAGL,MAAM,CAACK,MAAM,GAAGL,MAAM,CAACK,MAAM,CAACC,OAAO,CAAC,gBAAgB,EAAE,QAAQ,CAAC,GAAG,EAAE;MACtFN,MAAM,CAACG,QAAQ,0CAAsCH,MAAM,CAACG,QAAQ,CAACG,OAAO,CAAC,gBAAgB,EAAE,QAAQ,CAAG;IAC5G;IAEAT,kBAAkB,CAACG,MAAM,CAAC;EAC5B,CAAC;EAED,OAAOJ,QAAQ;AACjB,CAAC;AAACW,OAAA,CAAAZ,wBAAA,GAAAA,wBAAA"}