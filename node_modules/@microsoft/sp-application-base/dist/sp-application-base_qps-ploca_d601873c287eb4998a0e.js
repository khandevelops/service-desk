define("4df9bb86-ab0a-4aab-ab5f-48bf167048fb_1.17.1",["tslib","@microsoft/sp-http-base","@ms/sp-telemetry","@microsoft/sp-component-base","@microsoft/sp-loader","@ms/odsp-core-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-extension-base","@microsoft/sp-diagnostics","@microsoft/sp-http"],function(n,a,i,r,o,s,c,d,l,u,f,p){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,d=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);d.length;)d.shift()()}var n={},a={0:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,i){n=a[e]=[t,i]});t.push(n[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"chunk."+({1:"sp-navigation-datastore"}[e]||e)+"_"+"none"+"_"+{1:"2df37b8255059be5e3d9"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}a[e]=void 0}};var d=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp_4df9bb86_ab0a_4aab_ab5f_48bf167048fb_1_17_1=window.webpackJsonp_4df9bb86_ab0a_4aab_ab5f_48bf167048fb_1_17_1||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var c=o;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-application-base_qps-ploca_d601873c287eb4998a0e\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="mwqp")}({"17wl":function(e,t){e.exports=n},"2SXB":function(e,t){e.exports=a},"2q6Q":function(e,t){e.exports=i},"7Awa":function(e,t){e.exports=r},GuP6:function(e){e.exports=JSON.parse('{"t":"Àƥƥĺĩćàţĩōń ƒàĩĺēď ţō ĺōàď. Ĩď: \\u0022{0}\\u0022.\\nĒŕŕōŕ: {1}","e":"Ēŕŕōŕ ĩńĩţĩàĺĩźĩńĝ àƥƥĺĩćàţĩōń. Ēŕŕōŕ: {0}","n":"Ćĺĩćķ ţō ƥŕōvĩďē àďďĩţĩōńàĺ ćŕēďēńţĩàĺś."}')},I6O9:function(e,t){e.exports=o},K9kD:function(e,t){e.exports=s},Pk8u:function(e,t){e.exports=c},UWqr:function(e,t){e.exports=d},"X+PM":function(e,t){e.exports=l},ZFc5:function(e,t){e.exports=u},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"ApplicationCustomizerContext",function(){return ee}),n.d(t,"BaseApplicationCustomizer",function(){return V}),n.d(t,"ApplicationAccessor",function(){return $}),n.d(t,"_DialogManagerConfiguration",function(){return J}),n.d(t,"_SearchQueryManager",function(){return W}),n.d(t,"PlaceholderContent",function(){return l}),n.d(t,"PlaceholderName",function(){return f}),n.d(t,"_Placeholder",function(){return p}),n.d(t,"PlaceholderProvider",function(){return _}),n.d(t,"_PlaceholderManager",function(){return m}),n.d(t,"BaseApplication",function(){return Z}),n.d(t,"_OnBeforeNavigationEventName",function(){return T}),n.d(t,"BaseApplicationContext",function(){return x}),n.d(t,"_ApplicationManager",function(){return X}),n.d(t,"_Navigator",function(){return Y}),n.d(t,"_NavigationDataError",function(){return F}),n.d(t,"_NavigationErrorCode",function(){return P}),n.d(t,"_PrefetchedDataEventArgs",function(){return Q}),n.d(t,"_ApplicationLoadType",function(){return L});var a={};n.r(a),n.d(a,"Default",function(){return v}),n.d(a,"Tenant",function(){return y}),n.d(a,"Hub",function(){return S}),n.d(a,"Site",function(){return D});var i,r=n("17wl"),o=n("ZFc5"),s=n("7Awa"),c=n("ut3N"),d=n("UWqr"),l=function(){function e(e){this._disposeHandler=void 0,this._isDisposed=!1,this._placeholder=e.placeholder,this._disposeHandler=e.options?e.options.onDispose:void 0,this._domElement=e.domElement}return Object.defineProperty(e.prototype,"name",{get:function(){return this._placeholder.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"domElement",{get:function(){return this._domElement},enumerable:!1,configurable:!0}),e.prototype._setPlaceholder=function(e){this._placeholder=e},e.prototype._setOptions=function(e){this._disposeHandler=e&&e.onDispose},e.prototype.dispose=function(){if(!this._isDisposed){if(this._disposeHandler)try{this._disposeHandler(this)}catch(t){c._TraceLogger.logError(e._logSource,new Error("The onDispose API threw an exception for placeholder '".concat(this._placeholder.name,"'. Error information is '").concat(t.message,"'")))}this._placeholder.removePlaceholderContent(this),delete this._domElement,delete this._placeholder,delete this._disposeHandler}this._isDisposed=!0},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return document.body.contains(this._domElement)},enumerable:!1,configurable:!0}),e._logSource=c._LogSource.create("Placeholder"),e}();!function(e){e[e.Top=1]="Top",e[e.Bottom=2]="Bottom"}(i||(i={}));var u,f=i,p=function(){function e(e,t){this._entries=[],d.Validate.isNotNullOrUndefined(e,"definition"),d.Validate.isNotNullOrUndefined(e.domElement,"definition.domElement"),d.Validate.isNotNullOrUndefined(t,"manager"),this._name=e.name,this._domElement=e.domElement,this._applicationDomElement=void 0}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e.prototype.createPlaceholderContent=function(e,t){var n=document.createElement("div");n.classList.add("ms-SPLegacyFabricBlock");var a=this._addContentDiv(n,e),i=new l({placeholder:this,sequence:e,domElement:n,options:t});return this._entries.splice(a,0,{placeholderContent:i,sequence:e}),i},e.prototype.removePlaceholderContent=function(e){for(var t=0;t<this._entries.length;t++)this._entries[t].placeholderContent===e&&(this._domElement.removeChild(this._entries[t].placeholderContent.domElement),this._entries.splice(t,1),t--)},e.prototype.attachToApplication=function(e){this._applicationDomElement=e,this._applicationDomElement.appendChild(this._domElement)},e.prototype.detachFromApplication=function(){this._applicationDomElement&&(this._applicationDomElement.appendChild(this._domElement),this._applicationDomElement=void 0)},e.prototype._addContentDiv=function(e,t){var n;if(this.name===f.Bottom)for(n=this._entries.length;n>0&&t>this._entries[n-1].sequence;)n--;else for(n=0;n<this._entries.length&&t>=this._entries[n].sequence;)n++;if(n<this._entries.length){var a=this._entries[n].placeholderContent.domElement;this._domElement.insertBefore(e,a)}else this._domElement.appendChild(e);return n},e}(),m=function(){function e(t){this._isEnabled=!1,this._changedEvent=new d.SPEvent(e.placeholdersChangedEventName),this._placeholders=new Map,this._placeholders.set(f.Top,this._createPlaceholder(f.Top)),this._placeholders.set(f.Bottom,this._createPlaceholder(f.Bottom))}return Object.defineProperty(e.prototype,"changedEvent",{get:function(){return this._changedEvent},enumerable:!1,configurable:!0}),e.prototype.initializePlaceholders=function(e){var t=this;d.Validate.isNotNullOrUndefined(e,"definitions"),e.forEach(function(e){return t.addPlaceholder(e.name,e.domElement)})},e.prototype.addPlaceholder=function(t,n){d.Validate.isTrue(this.placeholders.has(t),"placeholder exists"),this._placeholders.get(t).attachToApplication(n),d._SPEventManager.instance.raiseStickyEvent(e.placeholdersChangedEventName,new d.SPEventArgs)},e.prototype.removePlaceholder=function(t){d.Validate.isTrue(this.placeholders.has(t),"placeholder exists"),this._placeholders.get(t).detachFromApplication(),d._SPEventManager.instance.raiseStickyEvent(e.placeholdersChangedEventName,new d.SPEventArgs)},e.prototype.registerPlaceholders=function(){for(var e="data-sp-placeholder",t=document.querySelectorAll("[".concat(e,"]")),n=[],a=0;a<t.length;a++){var i=t[a],r=i.getAttribute(e);if(i&&r){var o=f[r];if("number"!=typeof o)throw new Error("Invalid placeholder definition: "+r);n.push({name:o,domElement:i})}}this.initializePlaceholders(n)},Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),e.prototype._enable=function(){this._isEnabled=!0},Object.defineProperty(e.prototype,"placeholders",{get:function(){return this._placeholders},enumerable:!1,configurable:!0}),e.prototype._createPlaceholder=function(e){return new p({name:e,domElement:document.createElement("div")},this)},e.serviceKey=d.ServiceKey.create("sp-application-base:PlaceholderManager",e),e.placeholdersChangedEventName="placeholders.changedEvent",e}(),_=function(){function e(e,t,n){this._placeholderContents=[],this._isDisposed=!1,this._sequence=t.sequence;var a=new c._QosMonitor("PlaceholderProvider"),i=t.preAllocatedApplicationCustomizerTopHeight,r=t.preAllocatedApplicationCustomizerBottomHeight;this._componentTag=n||"",this._placeholderManager=e.consume(m.serviceKey),i>0&&(this._preAllocatedTopPlaceholderContent=this._preAllocateContent(f.Top,i,a)),r>0&&(this._preAllocatedBottomPlaceholderContent=this._preAllocateContent(f.Bottom,r,a)),a.writeSuccess({name:name})}return e.prototype.dispose=function(){this._isDisposed||(this._placeholderContents.forEach(function(e){return e.dispose()}),delete this._placeholderContents,delete this._placeholderManager),this._isDisposed=!0},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.tryCreateContent=function(t,n){c._TraceLogger.logVerbose(e._logSource,'Creating placeholder content in placeholder "'.concat(t,'"'));var a,i=new c._QosMonitor("Placeholder.tryCreateContent");return t===f.Top&&this._preAllocatedTopPlaceholderContent?(a=this._preAllocatedTopPlaceholderContent,this._preAllocatedTopPlaceholderContent=void 0):t===f.Bottom&&this._preAllocatedBottomPlaceholderContent&&(a=this._preAllocatedBottomPlaceholderContent,this._preAllocatedBottomPlaceholderContent=void 0),a?(a._setOptions(n),this._postContentCreation(a,i),a.domElement.innerHTML="",a):this._tryCreateContent(i,t,n)},e.prototype._preAllocateContent=function(e,t,n){if(0===this._placeholderManager.changedEvent._listenerCount()&&console.log("tryCreateContent was called, but PlaceholderProvider.changedEvent has no handlers. This is likely to cause an error in the future.  You should probably be calling tryCreateContent in the PlaceholderProvider.changedEvent callback."),this._placeholderManager.isEnabled&&this._placeholderManager.placeholders.has(e)){var a=this._placeholderManager.placeholders.get(e),i=a.createPlaceholderContent(this._sequence);if(a){try{i.domElement.style.height=t+"px";var r=s._ShimmerFactory.createShimmer(i.domElement.clientWidth,t,f+this._componentTag,"",0);i.domElement.appendChild(r),n.writeSuccess({name:name})}catch(o){n.writeUnexpectedFailure("CreateContentFailed",o,{name:name})}return i}o=new Error("Placeholder dictionary has only the key but not the value for the placeholder"),n.writeUnexpectedFailure("NoValueInPlaceholdersMap",o,{name:name})}else{var o=new Error("No placeholder found with the name '".concat(name,"'"));n.writeExpectedFailure("PlaceholderNotFound",o,{name:name})}},Object.defineProperty(e.prototype,"placeholderNames",{get:function(){if(!this._placeholderManager.isEnabled)return[];var e=[];return this._placeholderManager.placeholders.forEach(function(t,n){return e.push(n)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"changedEvent",{get:function(){return this._placeholderManager.changedEvent},enumerable:!1,configurable:!0}),e.prototype._tryCreateContent=function(e,t,n){var a,i=this._placeholderManager.placeholders.get(t);try{a=i.createPlaceholderContent(this._sequence,n)}catch(n){return void e.writeUnexpectedFailure("CreateContentFailed",n,{name:t})}return this._postContentCreation(a,e),a},e.prototype._postContentCreation=function(e,t){if(e)this._placeholderContents.push(e),t.writeSuccess({name:name});else{var n=new Error("Placeholder could not create new content");t.writeUnexpectedFailure("CreateContentUndefined",n,{name:name})}},e._logSource=c._LogSource.create("PlaceholderProvider"),e}(),h=n("I6O9"),b=n("2q6Q"),g=n("K9kD"),v=0,y=1,S=2,D=3,I=(g.Killswitch.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),"undefined"!=typeof window&&g.FeatureOverrides.isFeatureEnabled({ODB:1737}),3);!function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader",e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}(u||(u={}));var x=function(e){function t(t){var n=e.call(this,t)||this;return n._disposed=!1,n._preloadedData=t.navigator.preloadedData,n._navigator=t.navigator,n._chrome=t.chrome,n._loadType=t.loadType,n._prefetchedDataEvent=new d.SPEvent(Z._prefetchedDataEventName),n}return Object(r.__extends)(t,e),t.prototype.dispose=function(){this._disposed||(this._navigator&&(this._navigator=void 0),e.prototype.dispose.call(this),this._disposed=!0)},t.prototype.initializeSuiteNavManager=function(e){this._suiteNavManager=e},Object.defineProperty(t.prototype,"preloadedData",{get:function(){return this._preloadedData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"navigator",{get:function(){return this._navigator},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chrome",{get:function(){return this._chrome},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loadType",{get:function(){return this._loadType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"prefetchedDataEvent",{get:function(){return this._prefetchedDataEvent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suiteNavManager",{get:function(){return this._suiteNavManager},enumerable:!1,configurable:!0}),t.prototype._updateSecondFlushData=function(e){var t;this._preloadedData=e,null===(t=this._navigator)||void 0===t||t._setPreloadedData(e)},t}(s.BaseComponentContext),C=n("2SXB"),O=function(){function e(){}return e.isDuplicateErrorMessageV2KillSwitchActivated=function(){return d._SPKillSwitch.isActivated(d.Guid.parse("efa9490b-c037-465e-ae95-6eccef6061e8"),"5/11/20","Prevent duplicate error messages from appearing")},e.isChangeWorkloadForTeamsWorkBenchKSActivated=function(){return d._SPKillSwitch.isActivated("66f65dfa-6988-413b-a46d-6872886d05fb")},e.isPageTypeForLayoutsKSActivated=function(){return d._SPKillSwitch.isActivated("8b8d7a10-d7ba-47f5-8ed5-1aa72caf73ac")},e.isDisableNavigationCacheKSActivated=function(){return d._SPKillSwitch.isActivated("1f9b5b68-e4fa-4ca9-94df-b97b1af022f4")},e.isOriginalCorrelationIdKsActivated=function(){return d._SPKillSwitch.isActivated("1919365d-c673-4338-91e1-39661f5a34f0")},e.isAddEduClassToEngagementKSActivated=function(){return d._SPKillSwitch.isActivated("6529d10e-5177-40ef-9c95-4b3b947e8795")},e.isOverrideApplicationCustomizerDynamicDataSourceIdKSActivated=function(){return d._SPKillSwitch.isActivated("6529d10e-5177-40ef-9c95-4b3b947e8795")},e.isVivaHomeDisableExtensionsKSActivated=function(){return d._SPKillSwitch.isActivated("8bcd47e2-c168-47bb-bd9e-d4f3ce5b830a")},e.isVivaHomeDisableSearchQueryKSActivated=function(){return d._SPKillSwitch.isActivated("53c48b16-126f-4587-8de8-54f7059be35d")},e}();function w(){return d._SPKillSwitch.isActivated("3007279f-0df2-4ac9-a11e-e067d3be1058")}function E(){return d._SPKillSwitch.isActivated("3c191136-63f6-40dd-8e60-b170181959b9")}function A(){return d._SPKillSwitch.isActivated("1d595102-af19-4d7d-9574-fa7c9969464b")}var L,k=n("GuP6"),M=function(){function e(){this._didRenderError=!1}return e.prototype.setUpTokenAcquistionFailurePlaceholder=function(e,t){var n=this,a=C._AadTokenProviders.configurable,i=new _(t,{sequence:0,preAllocatedApplicationCustomizerBottomHeight:0,preAllocatedApplicationCustomizerTopHeight:0},"AAD Failure Placeholder"),r=t.consume(m.serviceKey);i.changedEvent.add(e,function(){n._aadPlaceHolderContent||(n._aadPlaceHolderContent=i.tryCreateContent(f.Top))}),a.tokenAcquisitionEvent.add(e,function(e){n._didRenderError||n.renderTokenAcquistionEvent(r.isEnabled,e)})},e.prototype.renderTokenAcquistionEvent=function(e,t){!O.isDuplicateErrorMessageV2KillSwitchActivated()&&this._didRenderError||(e&&this._aadPlaceHolderContent?this._renderTokenAcquistionPlaceholder(this._aadPlaceHolderContent,t):this._renderTokenAcquistionAlert(t)),this._didRenderError=!0},e.prototype._renderTokenAcquistionPlaceholder=function(e,t){e.domElement.setAttribute("style","text-align: center; padding: 10px; background-color:#fff4ce;");var n=document.createElement("span");if(n.innerText=t.message,e.domElement.appendChild(n),t.redirectUrl){var a=document.createElement("a");a.href=t.redirectUrl,a.innerText=k.n,e.domElement.appendChild(a)}},e.prototype._renderTokenAcquistionAlert=function(e){confirm(e.message)&&e.redirectUrl&&(window.location.href=e.redirectUrl)},e}();!function(e){e[e.FullPageLoad=0]="FullPageLoad",e[e.InPlaceNavigation=1]="InPlaceNavigation"}(L||(L={}));var P,T=function(e){function t(t,n){var a=this;return d.Validate.isNonemptyString(t,"fromAppId"),d.Validate.isNonemptyString(n,"toAppId"),(a=e.call(this)||this).fromAppId=t,a.toAppId=n,a}return Object(r.__extends)(t,e),t}(d.SPEventArgs),U=n("vlQI");!function(e){e[e.fetchData=0]="fetchData",e[e.parseData=1]="parseData",e[e.asyncError=2]="asyncError",e[e.syncError=3]="syncError",e[e.buildIdMismatch=4]="buildIdMismatch",e[e.unknown=5]="unknown"}(P||(P={}));var F=function(e){function t(n,a,i,r,o){void 0===r&&(r=!1);var s=e.call(this,P[n],a,o)||this;return s.__proto__=t.prototype,s._errorId=n,s.innerError=i,s._isExpected=r,s}return Object(r.__extends)(t,e),t.createNavigationError=function(e,n){d.Validate.isNotNullOrUndefined(n,"innerError");var a=t._isExpectedError(e),i=t._errorTemplate(e);return new t(e,d.Text.format(i,n.message),n,a)},t.sessionEndedReason=function(e,t){void 0===t&&(t="XApp");var n="RouteNav.";return e===P[P.parseData]?n+="Known.".concat(t,".MalformedJSON"):e===P[P.fetchData]?n+="Known.".concat(t,".NetworkError"):e===P[P.asyncError]?n+="Known.".concat(t,".asyncError"):e===P[P.syncError]?n+="Known.".concat(t,".syncError"):e===P[P.buildIdMismatch]?n+="Known.".concat(t,".buildIdMismatch"):n+="Unknown.".concat(t,".NavigationDataError"),n},t._isExpectedError=function(e){var t=e===P.buildIdMismatch;return e===P.parseData||t},t._errorTemplate=function(e){return t._errorCodeToTemplateMap[e]||"Failed to navigate. Error: {0}"},Object.defineProperty(t.prototype,"id",{get:function(){return this._errorId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"category",{get:function(){return"NavigationDataError"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpected",{get:function(){return this._isExpected},enumerable:!1,configurable:!0}),t._errorCodeToTemplateMap=new Map([[P.fetchData,"Failed to retrieve navigation data. Error: {0}"],[P.parseData,"Failed to parse navigation data. Error: {0}"],[P.asyncError,"Async Error. Error: {0}"],[P.syncError,"Sync Error. Error: {0}"],[P.buildIdMismatch,"Build ID mismatch. Error: {0}"]]),t}(d.SPError),H=function(){function e(e,t){d.Validate.isNotNullOrUndefined(e,"serviceScope"),d.Validate.isNotNullOrUndefined(t,"validator"),this._spHttpClient=e.consume(U.SPHttpClient.serviceKey),this._dataValidator=t}return e._generatePreloadHeaders=function(e){var t=new Headers;return e&&e.isPrefetchRequest&&t.append("X-RequestPrefetchLink","1"),window.__spfxMark&&t.append("X-Service-Worker-In-Place-Nav","true"),t},e._generatePrefetchHeaders=function(e){var t=new Headers;return t.append("X-RequestPrefetchData","1"),e&&e.isPrefetchRequest&&t.append("X-RequestPrefetchLink","1"),t},Object.defineProperty(e.prototype,"buildId",{get:function(){return this._buildId},set:function(e){this._buildId=e},enumerable:!1,configurable:!0}),e.prototype.getData=function(t,n){var a=this;if(d.Validate.isNonemptyString(t,"url"),O.isDisableNavigationCacheKSActivated())return this._getStore().then(function(e){return e.getData(t,n)});var i=this._fetchData(t,e._generatePreloadHeaders(n)).then(function(e){return a._dataValidator(e),e}),r=void 0;if(n&&n.enableDataPrefetch){var o=new c._QosMonitor("NavigationDataStore.fetchAppData");r=this._fetchData(t,e._generatePrefetchHeaders(n)).then(function(e){return o.writeSuccess(),e}).catch(function(e){throw o.writeUnexpectedFailure(e),e})}return Promise.resolve({preloadedData:i,prefetchedData:r})},e.prototype.invalidate=function(e){return O.isDisableNavigationCacheKSActivated()?this._getStore().then(function(t){t.remove(e)}):Promise.resolve()},e.prototype._getStore=function(){var t=this;return this._navigationStore?Promise.resolve(this._navigationStore):this._navigationStorePromise||(this._navigationStorePromise=n.e(1).then(n.bind(null,"oPyX")).then(function(n){return t._navigationStore=new n.default(e.storeKey,e.storeBuildIdKey,t._buildId,function(e,n){return t._fetchData(e,n)},t._dataValidator),t._navigationStore}))},e.prototype._fetchData=function(e,t){var n=e.split("#")[0];return this._spHttpClient.get(n+(-1===n.indexOf("?")?"?":"&")+"as=json",U.SPHttpClient.configurations.v1,t?{headers:t}:void 0).then(function(e){if(e.ok)return e.json().catch(function(e){throw F.createNavigationError(P.parseData,e)});throw F.createNavigationError(P.fetchData,new Error(e.statusMessage))})},e.storeKey="sp-application-base:NavigationDataStore",e.storeBuildIdKey="sp-application-base:NavigationDataStore:buildId",e}(),R=n("X+PM"),N=n("Pk8u"),B=function(){function e(e){this.applicationCustomizerTopHeight="preAllocatedApplicationCustomizerTopHeight",this.applicationCustomizerBottomHeight="preAllocatedApplicationCustomizerBottomHeight",d.Validate.isNotNullOrUndefined(e,"serviceScope"),this._serviceScope=e}return e.prototype.createApplicationCustomizerContext=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!0);var a=e.clientSideComponentId.toString(),i=0,r=0;e.hostProperties&&(i=parseInt(JSON.parse(e.hostProperties)[this.applicationCustomizerTopHeight],10)||0,r=parseInt(JSON.parse(e.hostProperties)[this.applicationCustomizerBottomHeight],10)||0);var o,s={sequence:void 0!==e.sequence?e.sequence:65535,preAllocatedApplicationCustomizerTopHeight:i,preAllocatedApplicationCustomizerBottomHeight:r};if(n){var c=h.SPComponentLoader.tryGetManifestById(a);if(!c)throw new Error('Custom action with component id "'.concat(a,"\" didn't have a manifest."));var l=d.Guid.newGuid().toString(),u="Extension.".concat(c.id,".").concat(l);o=new ee({manifest:c,parentServiceScope:this._serviceScope,instanceId:l,loggingTag:u},s)}else o=new ee(t,s);return o},e}(),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype._initializeExtensionType=function(){e.prototype._initializeExtensionType.call(this);var t=new c._QosMonitor("BaseApplicationCustomizer.onPlaceholdersChanged.setUp");1===this.onPlaceholdersChanged.length?(this._placeholdersChangedCallback=this.onPlaceholdersChanged.bind(this,this.context.placeholderProvider),this.context.placeholderProvider.changedEvent.add(this,this._placeholdersChangedCallback),t.writeSuccess()):t.writeExpectedFailure("DifferentSignature")},Object.defineProperty(t.prototype,"_dynamicDataSourceId",{get:function(){return O.isOverrideApplicationCustomizerDynamicDataSourceIdKSActivated()?"".concat(this.manifest.componentType,".").concat(this.manifest.id,".").concat(this.instanceId):"".concat(this.manifest.componentType,".").concat(this.manifest.id)},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._placeholdersChangedCallback&&this.context.placeholderProvider.changedEvent.remove(this,this._placeholdersChangedCallback),e.prototype.dispose.call(this)},t.prototype.onPlaceholdersChanged=function(e){},t}(o.BaseExtension),V=j,z=function(){function e(){}return e._tryCreateFromPreloadedCustomAction=function(t){var n=void 0,a=new c._QosMonitor("ClientSideCustomActions.CreateFromPreloadedCustomAction");try{n=new e;var i=t.clientSideComponentId;if(d.Validate.isNonemptyString(i,"customAction.clientSideComponentId"),d.Validate.isNonemptyString(t.location,"customAction.location"),d.Validate.isNotNullOrUndefined(d.Guid.tryParse(i),"customAction.clientSideComponentId as Guid"),!h.SPComponentLoader.tryGetManifestById(i)){var r=new Error('Custom action with component id "'.concat(i,"\" didn't have a manifest."));throw a.writeUnexpectedFailure("ManifestNotFound",r,{customAction:i}),r}n.title=t.title,n.location=t.location,n.clientSideComponentId=d.Guid.parse(i),n.clientSideComponentProperties=t.clientSideComponentProperties,n.registrationType=t.registrationType,n.registrationId=t.registrationId,n.sequence=t.sequence,n.hostProperties=t.hostProperties,n.requireSiteAdministrator=t.requireSiteAdministrator,n.id=d.Guid.tryParse(t.id);var o=t.rights;return o&&void 0!==o.High&&void 0!==o.Low?n.rights=new R.SPPermission(o):c._TraceLogger.logVerbose(e._logSource,"The rights object has invalid format. One of High or Low fields cannot be undefined. Object value is '".concat(JSON.stringify(o))),a.writeSuccess({customAction:n.tag}),n}catch(r){return c._TraceLogger.logError(e._logSource,new Error("Failed to create client-side custom action. Error: ".concat(r.message))),void a.writeUnexpectedFailure("UnhandledCreateError",r,{customAction:t.clientSideComponentId})}},e._tryCreateFromDebugData=function(t,n,a,i,r){try{d.Validate.isNotNullOrUndefined(n,"clientSideComponentId"),d.Validate.isNonemptyString(t,"location");var o=new e;return o.location=t,o.clientSideComponentId=n,o.clientSideComponentProperties=a,o.sequence=i,o.hostProperties=r,o}catch(t){return void c._TraceLogger.logError(e._logSource,new Error("Failed to create client-side custom action. Error: ".concat(t.message)))}},Object.defineProperty(e.prototype,"tag",{get:function(){return"".concat(this.location,".").concat(this.clientSideComponentId.toString())},enumerable:!1,configurable:!0}),e._logSource=c._LogSource.create("ClientSideCustomAction"),e}(),G=function(){function e(){}return e.APPLICATION_CUSTOMIZER="ClientSideExtension.ApplicationCustomizer",e.LISTVIEW_COMMANDSET_CONTEXTMENU="ClientSideExtension.ListViewCommandSet.ContextMenu",e.LISTVIEW_COMMANDSET_COMMANDBAR="ClientSideExtension.ListViewCommandSet.CommandBar",e.LISTVIEW_COMMANDSET_DEFAULT="ClientSideExtension.ListViewCommandSet",e.SEARCH_QUERY_MODIFIER="ClientSideExtension.SearchQueryModifier",e}(),K=function(){function e(e){var t=this;this._customActionFromPreloadedData=[],this._debugCustomActions=[],this._debugCustomizerLoaded=!1,d.Validate.isNotNullOrUndefined(e,"serviceScope"),this._serviceScope=e,this._extensionManager=new o._ExtensionManager(this._serviceScope,V),this._applicationCustomizerContextFactory=new B(this._serviceScope),e.whenFinished(function(){t._placeholderManager=e.consume(m.serviceKey),t._placeholderManager._enable()}),this._currentCustomActions=new Set}return e.prototype.loadExtensions=function(t){var n=this,a=new Set(t),i=this._currentCustomActions.size>0,r=this._hasDebugCustomActions(),o=a.size>0||r,s=!i&&!o||i&&o&&Object(N.isEqual)(this._currentCustomActions,a),d=!1;return i&&!s&&(c._TraceLogger.logVerbose(e._logSource,"Disposing existing extensions"),this.disposeExtensions(),d=!0),this._currentCustomActions=a,o&&!s||r&&d?(c._TraceLogger.logVerbose(e._logSource,"Loading new extensions"),this._loadExtensions(t).then(function(){return n._loadDebugCustomizerIfEnabled()})):this._loadDebugCustomizerIfEnabled()},e.prototype.disposeExtensions=function(){this._extensionManager.disposeExtensions(),this._debugCustomizerLoaded=!1,this._currentCustomActions.clear()},Object.defineProperty(e.prototype,"_customActions",{get:function(){return this._debugCustomActions.concat(this._customActionFromPreloadedData)},enumerable:!1,configurable:!0}),e.prototype._loadDebugCustomizerIfEnabled=function(){var t=this,n="d29758ba-0fc0-4eac-bcfd-7fe5a7d0bc32";if(d._SPFlight.isDebugFlightEnabled&&d._SPFlight.isEnabled(1178)&&!this._debugCustomizerLoaded&&(d._SPFlight.isEnabled(60787)||this._isDebugModeOn(void 0))){var a=z._tryCreateFromDebugData("ClientSideExtension.ApplicationCustomizer",d.Guid.parse(n),void 0,0);if(a)return this._debugCustomizerLoaded=!0,h._ManifestStore.instance.requestManifest(n).then(function(){t._createApplicationCustomizer(a)}).catch(function(t){c._TraceLogger.logError(e._logSource,t)})}return Promise.resolve()},e.prototype._loadExtensions=function(e){this._loadCustomActions(e);for(var t=[],n=0,a=this._customActions;n<a.length;n++){var i=a[n];i.location===G.APPLICATION_CUSTOMIZER&&t.push(this._createApplicationCustomizer(i))}return Promise.all(t).then(function(e){})},e.prototype._createApplicationCustomizer=function(t){var n=this,a=new c._QosMonitor("ApplicationCustomizer.Create");return this._extensionManager.createExtension(t.clientSideComponentId.toString(),t.clientSideComponentProperties,function(e){return n._applicationCustomizerContextFactory.createApplicationCustomizerContext(t,e,!1)}).then(function(e){return a.writeSuccess(n._createQosExtraData(t)),e}).catch(function(i){var r=new Error("Failed to create application customizer '".concat(t.tag,"'. Error information is '").concat(i.message,"'."));throw a.writeExpectedFailure("FailedCreateExtension",i,n._createQosExtraData(t)),c._TraceLogger.logError(e._logSource,r),r})},e.prototype._createQosExtraData=function(e){return{customAction:e.tag}},e.prototype._loadCustomActions=function(e){this._customActionFromPreloadedData=this._loadCustomActionsFromPreloadedData(e),this._debugCustomActions=this._loadCustomActionsFromQueryParameter()},e.prototype._loadCustomActionsFromPreloadedData=function(e){var t=[];if(e)for(var n=0,a=e;n<a.length;n++){var i=a[n];if(i.location===G.APPLICATION_CUSTOMIZER){var r=z._tryCreateFromPreloadedCustomAction(i);r&&t.push(r)}}return t},e.prototype._hasDebugCustomActions=function(){var e=new URL(window.location.href).searchParams;return!!e.get("customActions")||d._SPFlight.isDebugFlightEnabled&&d._SPFlight.isEnabled(1178)&&(d._SPFlight.isEnabled(60787)||this._isDebugModeOn(e))},e.prototype._isDebugModeOn=function(e){return e||(e=new URL(window.location.href).searchParams),sessionStorage.getItem("spfx-debug")?!e.get("istabtest"):!!e.get("debug")},e.prototype._loadCustomActionsFromQueryParameter=function(){var e=new URL(window.location.href).searchParams.get("customActions"),t=[];if(e){var n=new c._QosMonitor("ApplicationCustomizerLoader.parseQueryParam");try{var a=decodeURIComponent(e),i=JSON.parse(a),r=[];if(i)for(var o=0,s=Object.keys(i);o<s.length;o++){var l=s[o],u=d.Guid.tryParse(l),f=i[l].location,p=i[l].properties,m=i[l].hostProperties,_=i[l].sequence;if(d.Validate.isNotNullOrUndefined(u,"clientSideComponentId"),d.Validate.isNotNullOrUndefined(f,"location"),h.SPComponentLoader.tryGetManifestById(u.toString())){if(u&&f){var b=z._tryCreateFromDebugData(f,u,p?JSON.stringify(p):"",_,m?JSON.stringify(m):"");b&&t.push(b)}}else r.push(u)}r.length>0?this._processMissingManifestsErrors(r,n):n.writeSuccess()}catch(t){this._processQueryParamParseErrors(t,e,n)}}return t},e.prototype._processMissingManifestsErrors=function(t,n){var a=new Error("Custom action component ids are specified by query parameters but matching manifests cannot be found. Ids: "+t.join(", "));c._TraceLogger.logError(e._logSource,a,"parseCustomActionsQueryParameter"),console.error(a.message),n.writeExpectedFailure("ManifestNotFound",a)},e.prototype._processQueryParamParseErrors=function(t,n,a){c._TraceLogger.logError(e._logSource,new Error('Failed to parse the "customActions" URL query parameter:'+t.message)),console.error('The "customActions" URL query parameter is improperly formatted: '+decodeURIComponent(n)),a.writeExpectedFailure("ParseFailure",t)},e._logSource=c._LogSource.create("ApplicationCustomizerLoader"),e}(),W=function(){function e(e){this._isInitialized=!1,this._areExtensionsLoaded=!1,this._serviceScope=e}return e.prototype.initialize=function(e,t){this._preloadedData=e,this._updateSearchBoxText=t;var n=new URL(window.location.href).searchParams;return this._isInitialized=!1,this._areExtensionsLoaded=!1,this._getUrlSearchQuery(n)&&this._hasExtensions(n)?this._initializeExtensions("initialize"):(this._isInitialized=!0,this._areExtensionsLoaded=!1,Promise.resolve())},e.prototype.updateFromQueryString=function(e){var t=new URLSearchParams(e.substring(1)),n=this._getUrlSearchQuery(t);return n&&this._updateSearchBoxText&&this._updateSearchBoxText(this._serviceScope,n),n&&this._hasExtensions(t)&&!this._areExtensionsLoaded?this._initializeExtensions("update"):Promise.resolve()},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.getSearchData=function(){if(!this._isInitialized)return Promise.reject(new Error("SearchQueryManager is not initialized"));var e,t=d._SPFlight.isEnabled(1534)||1===d._SPExperiment.getVariantAndLogExposure(90097),n=new URL(window.location.href).searchParams,a=this._getUrlSearchQuery(n);if(t&&(e=this._getUrlSearchScope(n)),a&&this._hasExtensions(n)){var i=new c._QosMonitor("SearchQueryManager.getSearchData");return this._getExtensionManager().then(function(e){return e.getSearchQuery(a)}).then(function(n){return i.writeSuccess(),t?{searchQuery:n,searchScope:e}:{searchQuery:n}}).catch(function(e){throw i.writeUnexpectedFailure(void 0,e),e})}return Promise.resolve(t?{searchQuery:a,searchScope:e}:{searchQuery:a})},e.prototype._getUrlSearchQuery=function(e){return e.get("q")||e.get("k")||void 0},e.prototype._getUrlSearchScope=function(e){return e.get("scope")||void 0},e.prototype._hasExtensions=function(e){return e.has("customActions")||!!this._preloadedData.customActions&&this._preloadedData.customActions.some(function(e){return e.location===G.SEARCH_QUERY_MODIFIER})},e.prototype._getExtensionManager=function(){var e=this;return this._extensionManagerPromise||(this._extensionManagerPromise=h.SPComponentLoader.loadComponentById("4958ea79-6ff3-4480-8291-0932dd010869").then(function(t){return new t._SearchQueryExtensionManager(e._serviceScope)})),this._extensionManagerPromise},e.prototype._initializeExtensions=function(e){var t=this,n=new c._QosMonitor("SearchQueryManager."+e);return this._getExtensionManager().then(function(e){return e.initializeExtensions(t._preloadedData.customActions).then(function(e){t._areExtensionsLoaded=!0,t._isInitialized=!0,n.writeSuccess({numberOfExtensions:e})})}).catch(function(e){throw n.writeUnexpectedFailure(void 0,e,{numberOfExtensions:0}),e})},e.serviceKey=d.ServiceKey.create("sp-application-base:SearchQueryManager",e),e}(),q=function(){function e(e,t,n){this._numAppsInitializedInSession=0,d.Validate.isNotNullOrUndefined(e,"serviceScope"),this._applicationManager=t||new X(e,n),this._pageContext=e.consume(R.PageContext.serviceKey),this._searchQueryManager=e.consume(W.serviceKey),this._applicationCustomizerLoader=new K(e)}return e.prototype.navigate=function(t){var n,a=this,i=this._applicationManager.currentApplicationId,r=!i.equals(d.Guid.empty),o=i.equals(d.Guid.tryParse(t.clientSideApplicationId)||d.Guid.empty);if(o&&r&&i.equals(d.Guid.tryParse(e.spListHostComponentId)))throw new b._QosMonitor("ListHostBlankPage").writeSuccess(),new Error("SP-List-Host App: Navigation within the listhost app is not supported.");var s=o||!r,c=this._isNavigationSupportedWithReason(t,this._pageContext,s);if(void 0!==c)return Promise.resolve({preloadedData:t,application:void 0,operation:"Unsupported",unsupportedReason:c});Y.clearNavigatedEventQueue(),this._fixPreloadedDataItem(t);var l=this._isCrossSite(t,this._pageContext),u=R.SharePointPageContextDataProvider._createPageContextData(t.spPageContextInfo);return u.listItem&&(u.listItem.uniqueId=null===(n=t.item)||void 0===n?void 0:n.UniqueId),this._pageContext.initialize(u,t.spPageContextInfo),window.__spfxMark?h._ManifestStore.instance.registerManifests(t.manifests,!1):h._ManifestStore.instance.replaceManifests(t.manifests),l&&!X._isChromelessApplication(t.clientSideApplicationId)&&r&&o&&this._applicationManager.currentApplication._loadTheme(),this._updateTelemetry(t),t.spPageContextInfo=void 0,d.Session._changePage(),t.clientSideApplicationId&&d.Session._setClientSideApplicationId(t.clientSideApplicationId),e.spListHostComponentId!==t.clientSideApplicationId&&Y.raiseNavigatedEvent(),o?(this._initializeSearchQuery(t),this._loadApplicationCustomizers(t),Promise.resolve({preloadedData:t,application:this._applicationManager.currentApplication,operation:"UpdateContext",isXSite:l})):(b._PerformanceLogger.markCrossAppNavigationStart(),this._applicationManager.startApplication(t).then(function(n){return a._numAppsInitializedInSession++,a._initializeSearchQuery(t),a._loadApplicationCustomizers(t),e.spListHostComponentId===t.clientSideApplicationId&&(window.moduleLoaderPromise=Promise.resolve(n)),Promise.resolve({preloadedData:t,application:n,operation:"LoadApplication",isXSite:l})}))},e.prototype._loadApplicationCustomizers=function(t){return this._appSupportsExtensions(t)?(c._TraceLogger.logVerbose(e._logSource,"Loading application customizers"),this._applicationCustomizerLoader.loadExtensions(t.customActions)):(c._TraceLogger.logVerbose(e._logSource,"Application Customizer is not supported for classic pages and workbench."),Promise.resolve())},e.prototype._disposeApplicationCustomizers=function(){this._applicationCustomizerLoader.disposeExtensions()},e.prototype._initializeSearchQuery=function(t){var n=this;return t.clientSideApplicationId===e.classicPagesComponentId||t.clientSideApplicationId===e.workbenchComponentId||t.clientSideApplicationId===e.spHomeComponentId||!O.isVivaHomeDisableSearchQueryKSActivated()&&t.clientSideApplicationId===e.spVivaHomeComponentId?Promise.resolve():this._searchQueryManager.initialize(t,function(e,t){if(n._applicationManager.currentApplicationId!==d.Guid.empty){var a=n._applicationManager.currentApplication._getPageChromeProvider();null==a||a.updateSearchBoxText(e,t)}}).then(function(){return n._searchQueryManager.getSearchData()}).then(function(e){d._SPFlight.isEnabled(1534)||1===d._SPExperiment.getVariantAndLogExposure(90097)?n._pageContext._setSearchData(e):n._pageContext._setSearchQuery(e.searchQuery)})},e.prototype._appSupportsExtensions=function(t){return!(t.clientSideApplicationId===e.classicPagesComponentId||!O.isVivaHomeDisableExtensionsKSActivated()&&t.clientSideApplicationId===e.spVivaHomeComponentId)},e.prototype._updateTelemetry=function(e){var t,n,a,i,r,o=e&&e.manifests&&e.manifests.length>0?e.manifests[0].alias:"";if(!d._SPKillSwitch.isActivated("da8015f3-c5fe-45f3-9220-ca73eb5cf979")&&o&&e.manifests[0].experimentalData&&e.manifests[0].experimentalData[h._INCLUDE_APP_WORKLOAD])try{var s=new URL(window.location.href);s.searchParams.get(h._APP_WORKLOAD_QSP)&&(o+="-"+s.searchParams.get(h._APP_WORKLOAD_QSP))}catch(e){}var l,u,f,p=this._pageContext.legacyPageContext,m=p.isHubSite,_=p.webTemplate,g=p.hubSiteId,v=p.isEduClass;if(e&&e.item)l=e.item.PageLayoutType,u=e.item.PromotedState,f=e.item.UniqueId;else if(!O.isPageTypeForLayoutsKSActivated()){var y="/_layouts/15/",S=window.location.href,D=S.toLowerCase(),I=D.indexOf(y),x=void 0;if(I>-1){var C=D.indexOf(".aspx"),w=S.substring(I+y.length,C>-1?C:void 0);x="SystemLayouts_".concat(w)}else x="CrossApp";l=x}r={pageId:f,isHubSite:m,webTemplate:_,pageType:l,promotedState:u,hubSiteId:m?g:void 0,isEduClass:O.isAddEduClassToEngagementKSActivated()?void 0:v};var E=!O.isChangeWorkloadForTeamsWorkBenchKSActivated()&&window.location.href.indexOf("/_layouts/15/TeamsWorkBench.aspx")>-1?"TeamsWorkBench":o;b._Telemetry.updateSettings({siteId:this._pageContext.site.id.toString(),webId:this._pageContext.web.id.toString(),listId:(null===(t=this._pageContext.list)||void 0===t?void 0:t.id.toString())||"",listItemUniqueId:(null===(n=this._pageContext.listItem)||void 0===n?void 0:n.id.toString())||"",correlationId:this._pageContext.site.correlationId.toString(),clientSideApplicationId:e.clientSideApplicationId},this._pageContext.legacyPageContext,E),c._Diagnostics.updateSettings({siteId:this._pageContext.site.id.toString(),webId:this._pageContext.web.id.toString(),listId:(null===(a=this._pageContext.list)||void 0===a?void 0:a.id.toString())||"",listItemUniqueId:(null===(i=this._pageContext.listItem)||void 0===i?void 0:i.id.toString())||"",correlationId:this._pageContext.site.correlationId.toString(),contextInfo:r})},e.prototype._isCrossSite=function(e,t){return!(!t.isInitialized||d.Guid.parse(e.spPageContextInfo.webId).equals(t.web.id)&&d.Guid.parse(e.spPageContextInfo.siteId).equals(t.site.id))},e.prototype._fixPreloadedDataItem=function(e){return-1===e.spPageContextInfo.pageItemId&&e.item&&-1!==e.item.ID&&(e.spPageContextInfo.pageItemId=e.item.ID),e},e.prototype._isNavigationSupportedWithReason=function(t,n,a){return n.isInitialized&&n.cultureInfo.currentUICultureName!==t.spPageContextInfo.currentUICultureName?"LocaleChange":!a&&this._numAppsInitializedInSession>e.maxSupportedAppsInSession?"TransitionsExceeded":void 0},e.classicPagesComponentId="eb4b666b-5c29-4dad-9a99-23613f21a2b7",e.workbenchComponentId="8be81a5c-af38-4bb2-af97-afa3b64dfbed",e.spHomeComponentId="1f019ae1-2de1-4f44-b723-00a6ec1d7445",e.spListHostComponentId="9f012051-e030-4487-9eb7-3365d03be182",e.spVivaHomeComponentId="eb765a5a-9fec-4d59-8cca-6c623b450f0a",e._logSource=c._LogSource.create("NavigationOrchestrator"),e.maxSupportedAppsInSession=15,e}(),Q=function(e){function t(t,n,a){var i=this;return d.Validate.isNonemptyString(t,"id"),d.Validate.isNonemptyString(n,"url"),(i=e.call(this)||this).applicationId=t,i.url=n,i.data=a,i}return Object(r.__extends)(t,e),t}(d.SPEventArgs),Y=function(){function e(e,t){var n=this;d.Validate.isNotNullOrUndefined(e,"serviceScope"),this._navigationDataProvider=new H(e,function(e){n._validatePreloadedData(e)}),this._navigationOrchestrator=new q(e,t,this),O.isOriginalCorrelationIdKsActivated()||(this._spHttpClient=e.consume(U.SPHttpClient.serviceKey))}return e.raiseNavigatedEvent=function(){requestAnimationFrame(function(){setTimeout(function(){d._SPEventManager.instance.raiseStickyEvent(Z._navigatedEventName,{})},0)})},e.clearNavigatedEventQueue=function(){d._SPEventManager.instance._clearStickyEventQueue(Z._navigatedEventName)},Object.defineProperty(e.prototype,"preloadedData",{get:function(){return d.Validate.isNotNullOrUndefined(this._preloadedData,"preloadedData"),this._preloadedData},enumerable:!1,configurable:!0}),e.prototype.navigate=function(e,t){var n=this;d.Validate.isNonemptyString(e,"url");var a=new c._QosMonitor("Navigator.navigate");return!O.isOriginalCorrelationIdKsActivated()&&this._spHttpClient&&(this._spHttpClient.isNavigate=!0),this._navigationDataProvider.getData(e,t).then(function(t){if(!t.preloadedData)throw new Error("Preloaded Data is not available.");return t.preloadedData.then(function(a){return t.prefetchedData&&n._raisePrefetchDataEvent(e,a,t.prefetchedData),n.navigateToPreloadedData(a)}).then(function(e){return e&&"Unsupported"===e.operation?a.writeExpectedFailure("Unsupported"):a.writeSuccess(),!A()&&window.__LinkNavQoSEvent&&window.__LinkNavQoSEvent.writeSuccess({scenario:"Navigator.Navigate-Success"}),!O.isOriginalCorrelationIdKsActivated()&&n._spHttpClient&&(n._spHttpClient.isNavigate=!1),e})}).catch(function(e){var t=!1;throw e instanceof F&&(t=e.isExpected),t?a.writeExpectedFailure(void 0,e):a.writeUnexpectedFailure(void 0,e),!A()&&window.__LinkNavQoSEvent&&window.__LinkNavQoSEvent.writeSuccess({scenario:"Navigator.Navigate-Failure"}),e})},e.prototype.prefetch=function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},t),{isPrefetchRequest:!0}),a=new c._QosMonitor("Navigator.prefetch");return this._navigationDataProvider.getData(e,n).then(function(e){return a.writeSuccess(),e}).catch(function(e){a.writeUnexpectedFailure(void 0,e)})},e.prototype.navigateToPreloadedData=function(e){var t=this,n=new c._QosMonitor("Navigator.navigateToPreloadedData");try{return this._validatePreloadedData(e),this._preloadedData=e,this._navigationOrchestrator.navigate(e).then(function(e){return t._preloadedData=e.preloadedData,n.writeSuccess(),e}).catch(function(e){throw n.writeUnexpectedFailure("AsyncError",e),F.createNavigationError(P.asyncError,e)})}catch(e){var a=void 0;return e&&e._errorId===P.buildIdMismatch?(a=e,n.writeExpectedFailure("ValidationError",e,{error:"BuildIdMismatch"})):(a=F.createNavigationError(P.syncError,e),n.writeUnexpectedFailure("SyncError",e)),Promise.reject(a)}},e.prototype.navigateToApplication=function(e){var t=this,n=new c._QosMonitor("Navigator.navigateToApplication");try{return this._navigationDataProvider.buildId=this._getBuildId(e),this._validatePreloadedData(e),this._preloadedData=e,this._navigationOrchestrator.navigate(e).then(function(e){return t._preloadedData=e.preloadedData,n.writeSuccess(),Promise.resolve(e.application)})}catch(e){throw n.writeUnexpectedFailure(e),e}},e.prototype._loadApplicationCustomizers=function(e){return this._navigationOrchestrator._loadApplicationCustomizers(e)},e.prototype._disposeApplicationCustomizers=function(){this._navigationOrchestrator._disposeApplicationCustomizers()},e.prototype.invalidate=function(e){return this._navigationDataProvider.invalidate(e)},e.prototype._validatePreloadedData=function(e){d.Validate.isNotNullOrUndefined(e,"preloadedData"),d.Validate.isNotNullOrUndefined(e.spPageContextInfo,"preloadedData.spPageContextInfo"),d.Validate.isNonemptyString(e.clientSideApplicationId,"preloadedData.clientSideApplicationId");try{d.Validate.isTrue(this._navigationDataProvider.buildId===this._getBuildId(e),"NavigationDataProvider.buildId")}catch(e){throw F.createNavigationError(P.buildIdMismatch,e)}},e.prototype._raisePrefetchDataEvent=function(e,t,n){n.then(function(n){n&&d._SPEventManager.instance.raiseStickyEvent(Z._prefetchedDataEventName,new Q(t.clientSideApplicationId,e,n))})},e.prototype._getBuildId=function(e){try{if(e.buildNumber)return e.buildNumber;var t=e.manifests[0].loaderConfig.internalModuleBaseUrls[0];return t.slice(t.indexOf("sp-client-"),-1)}catch(e){return""}},e.prototype._setPreloadedData=function(e){this._preloadedData=e},e}(),J=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allowDialogs",{get:function(){return d.Validate.isNotNullOrUndefined(this._allowDialogs,"allowDialogs"),this._allowDialogs},set:function(e){d.Validate.isNotNullOrUndefined(e,"value"),this._allowDialogs=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"domElement",{get:function(){return d.Validate.isNotNullOrUndefined(this._domElement,"domElement"),this._domElement},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t){void 0===t&&(t=!0),this._allowDialogs=t,this._domElement=e},e.prototype.dispose=function(){this._allowDialogs=void 0,this._domElement=void 0},e}(),X=function(){function e(e,t){d.Validate.isNotNullOrUndefined(e,"serviceScope"),this._serviceScope=e,this._navigator=t||new Y(this._serviceScope,this)}return e._isChromelessApplication=function(e){return d.Environment.type===d.EnvironmentType.ClassicSharePoint||"b1ab4aaa-f779-405c-8683-d3a750b5d18d"===e||"c22967c0-666a-4f03-a8c4-545efb9183e1"===e||"ad084475-d3a1-478e-859b-7d9a31e86828"===e||!E()&&"efd6c8a7-f166-458c-905f-720088538e16"===e},e._isThemelessApplication=function(e){return"c22967c0-666a-4f03-a8c4-545efb9183e1"===e||"ad084475-d3a1-478e-859b-7d9a31e86828"===e||!E()&&"efd6c8a7-f166-458c-905f-720088538e16"===e},Object.defineProperty(e.prototype,"currentApplicationId",{get:function(){var e=this._currentApplication&&this._currentApplication.componentId;return e?d.Guid.parse(e):d.Guid.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentApplication",{get:function(){return d.Validate.isNotNullOrUndefined(this._currentApplication,"currentApplication"),this._currentApplication},enumerable:!1,configurable:!0}),e.prototype.startApplication=function(t){var n=this;try{d.Validate.isNonemptyString(t.clientSideApplicationId,"preloadedData.clientSideApplicationId")}catch(i){return Promise.reject(i)}var a=new c._QosMonitor("ApplicationManager.start");function i(t,n){var i=new Error(t);throw c._TraceLogger.logError(e._logSource,i),a.writeUnexpectedFailure(n,i),i}var r=t.clientSideApplicationId,o=h.SPComponentLoader.tryGetManifestById(r),s=o?h.SPComponentLoader.tryGetLoadedComponent(o):void 0;return s?this._initializeApplicationWithTelemetry(s,r,a,i):this._loadApplicationComponent(r,i).then(function(e){return n._initializeApplicationWithTelemetry(e,r,a,i)})},e.prototype._raiseOnBeforeNavigationEventName=function(e,t){d._SPEventManager.instance.raiseEvent(Z._onBeforeNavigationEventName,new T(e,t))},Object.defineProperty(e.prototype,"_applicationLoadType",{get:function(){return this._previousApplication?L.InPlaceNavigation:L.FullPageLoad},enumerable:!1,configurable:!0}),e.prototype._initializeApplicationWithTelemetry=function(e,t,n,a){return b._PerformanceLogger.markApplicationStart(),this._initializeApplication(new e.default,t).then(function(e){return n.writeSuccess(),e}).catch(function(e){return a(d.Text.format(k.e,e),"SPShell.Start")})},e.prototype._loadApplicationComponent=function(e,t){return h.SPComponentLoader.loadComponentById(e).catch(function(n){return t(d.Text.format(k.t,e,n.message),"ApplicationFailedToLoad")})},e.prototype._isChromelessApplication=function(t){return e._isChromelessApplication(t)},e.prototype._isThemelessApplication=function(t){return e._isThemelessApplication(t)},e.prototype._initializeApplication=function(e,t){var n=this;if("BaseApplication"!==e.__type)return Promise.reject(new Error("The application is not a subclass of BaseApplication"));var a=new c._QosMonitor("ApplicationManager.initialize"),i=h.SPComponentLoader.tryGetManifestById(t),r={alias:e.alias||i.alias,isInternal:i.isInternal,manifestId:i.id};this._currentApplication&&(this._previousApplication=this._currentApplication),this._currentApplication=e,this._previousApplication&&(this._raiseOnBeforeNavigationEventName(this._previousApplication.componentId,t),this._previousApplication._unload());var o=this._currentApplication._getPageChromeProvider(),s=this._isChromelessApplication(t);s||o&&(this._masterChrome||(this._masterChrome=o.initializeMasterChrome()),this._pageChrome||(this._pageChrome=o.initializePageChrome(this._serviceScope,this._masterChrome,t),J.instance.initialize(this._pageChrome.dialogContainerDiv)));try{return this._currentApplication._load({manifest:i,parentServiceScope:this._serviceScope,navigator:this._navigator,instanceId:i.id,loggingTag:"Application.".concat(i.id),chrome:this._pageChrome,loadType:this._applicationLoadType}).then(function(){return n._previousApplication&&(n._previousApplication.dispose(),n._previousApplication=void 0),o?(n._isThemelessApplication(t)||n._currentApplication._loadTheme(),s||n._currentApplication._render()):!w()&&s&&n._currentApplication._render(),a.writeSuccess(r),e}).catch(function(e){return a.writeUnexpectedFailure("AsyncError",e,r),Promise.reject(e)})}catch(e){return a.writeUnexpectedFailure("GeneralError",e,r),Promise.reject(e)}},e._logSource=c._LogSource.create("ApplicationManager"),e}(),Z=function(e){function t(){var t=e.call(this)||this;t._handleSecondFlush=function(e){t.context._updateSecondFlushData(e),t.onLoad().then(function(){t._onRender()}).catch(function(e){throw e})},t.__type="BaseApplication";var n=t._getPageChromeProvider();return n&&(t._themeManager=n.initializeThemeManager(function(){return t.context.serviceScope})),h._SPLoaderFlights._isMinimalStartFlightEnabled()&&(t._onSecondFlushEvent=new d.SPEvent("onSecondFlush"),t._onSecondFlushEvent.add(t,function(e){t._secondFlushEventRaised=!0,t._secondFlushPreloadedData=e})),t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"domElement",{get:function(){return d.Validate.isNotNullOrUndefined(this.context,"context"),d.Validate.isNotDisposed(this.context,"context"),d.Validate.isNotNullOrUndefined(this.context.chrome,"chrome"),d.Validate.isNotDisposed(this.context.chrome,"chrome"),this.context.chrome.appDiv},set:function(e){throw new Error("The property cannot be assigned because it is read-only")},enumerable:!1,configurable:!0}),t.prototype._load=function(e){var t=this,n=new c._QosMonitor("BaseApplication.load");try{var a=this._getApplicationContext(e);return this._initializeContext(a),(new M).setUpTokenAcquistionFailurePlaceholder(this,this.context.serviceScope),(h._SPLoaderFlights._isMinimalStartFlightEnabled()?this.onBeforeLoad().then(function(){if(t._secondFlushEventRaised)return t.context.preloadedData.isFirstFlush&&(c._EngagementLogger.logEvent("_load.SecondFlushBeforeFirstFlushFinished"),t.context._updateSecondFlushData(t._secondFlushPreloadedData)),t._loadedDuringFirstFlush=!0,t.onLoad()}):this.onLoad()).then(function(){return n.writeSuccess()}).catch(function(e){throw n.writeExpectedFailure("onLoadFailure",e),e})}catch(e){return n.writeUnexpectedFailure("SyncError",e),Promise.reject(e)}},t.prototype._render=function(){var e,t=new c._QosMonitor("BaseApplication.render");try{var n=this._getPageChromeProvider();if(void 0===n)return void(!w()&&X._isChromelessApplication(this.componentId)&&this._onRender());null===(e=this._themeManager)||void 0===e||e.flushStyles(),this.context.chrome.show();var a=this.context.loadType===L.FullPageLoad,i=null==n?void 0:n.initializeSuiteNavManager(this.context.serviceScope);if(i){var r=this.suiteNavConfiguration();i.initialize(this.context.chrome.suiteNavDiv,a),this.context.initializeSuiteNavManager(i),r&&!r.isSuiteNavDisabled()&&(d._SPFlight.isEnabled(1309)&&r.isSuiteNavLoadingDeferred()?("1f019ae1-2de1-4f44-b723-00a6ec1d7445"===this.componentId?b._PerformanceLogger.trackFlight(b._PerformanceFlight.CSISPHomeLazyLoadSearchPackage):b._PerformanceLogger.trackFlight(b._PerformanceFlight.CSISPPagesLazyLoadSearchPackage),i.loadSuiteNavNewFlow(r)):i.loadSuiteNav(r))}h._SPLoaderFlights._isMinimalStartFlightEnabled()&&!this._loadedDuringFirstFlush?this._onSecondFlushEvent.add(this,this._handleSecondFlush):this._onRender(),t.writeSuccess()}catch(e){throw t.writeUnexpectedFailure("onRenderError",e),e}},t.prototype._unload=function(){var e=new c._QosMonitor("BaseApplication.unload");try{this.onUnload(),e.writeSuccess()}catch(t){e.writeExpectedFailure("onUnloadError",t)}},t.prototype._loadTheme=function(){var e;if(!X._isThemelessApplication(this.componentId)){null===(e=this._themeManager)||void 0===e||e.registerOnThemeChangeCallback();var t=this._getThemeProvider();return t?t.loadThemedStyles():Promise.resolve()}return Promise.resolve()},t.prototype.dispose=function(){var t;null===(t=this._themeManager)||void 0===t||t.dispose(),this.onDispose(),e.prototype.dispose.call(this)},t.prototype.suiteNavConfiguration=function(){var e=this._getPageChromeProvider();if(e)return e.initializeSuiteNavManagerConfiguration(this._getSuiteNavManagerConfigurationData())},t.prototype._getApplicationContext=function(e){return new x(e)},t.prototype._getThemeProvider=function(){var e=this._getPageChromeProvider();if(e)return e.initializeThemeProvider(this.context.serviceScope)},t.prototype.onBeforeLoad=function(){return Promise.resolve()},t.prototype.onLoad=function(){return Promise.resolve()},t.prototype.onUnload=function(){},t.prototype.onRender=function(){},t.prototype.onDispose=function(){},t.prototype._getSuiteNavManagerConfigurationData=function(){var e,t=this.context.pageContext;e=t.legacyPageContext.webTemplateId;var n=t.legacyPageContext.searchBoxInNavBar===I;return{currentUICultureName:t.cultureInfo.currentUICultureName,disableSuiteNav:this._shouldDisableSuiteNav(),preloadedData:this.context.preloadedData,settingsData:t.legacyPageContext.MenuData?t.legacyPageContext.MenuData.SettingsData:void 0,signoutUrl:t.legacyPageContext.MenuData?t.legacyPageContext.MenuData.SignOutUrl:void 0,siteClientTag:t.legacyPageContext.siteClientTag,systemUserKey:t.legacyPageContext.systemUserKey,userDisplayName:t.user.displayName,webServerRelativeUrl:t.web.serverRelativeUrl,webTemplateId:e,disableSuiteNavSearchBox:n}},t.prototype._navigate=function(e,t){return d.Validate.isNonemptyString(e,"url"),this.context.navigator.navigate(e,t)},t.prototype._navigateToPreloadedData=function(e){d.Validate.isNotNullOrUndefined(e,"preloadedData"),this.context.navigator.navigateToPreloadedData(e)},t.prototype._invalidate=function(e){return d.Validate.isNotNullOrUndefined(e,"url"),this.context.navigator.invalidate(e)},t.prototype.raiseLayoutChangedEvent=function(){d._SPEventManager.instance.raiseEvent(t._layoutChangedEventName,{})},t.prototype._onRender=function(){this.onRender(),d._SPEventManager.instance.removeEvent("onSecondFlush")},t.prototype._shouldDisableSuiteNav=function(){var e=new d.UrlQueryParameterCollection(window.location.href);return"localhost"===window.location.hostname||"true"===e.getValue("disableSuiteNav")||d._BrowserUtilities.isEmbedded()||!this.manifest.hasSuiteNav},t._navigatedEventName="application.navigatedEvent",t._layoutChangedEventName="application.layoutChangedEvent",t._prefetchedDataEventName="application.prefetchedDataEvent",t._onBeforeNavigationEventName="application.onBeforeNavigationEventName",t}(s.BaseComponent),$=function(){function e(e){this._navigatedEvent=new d.SPEvent(Z._navigatedEventName),this._privateLayoutChangedEvent=new d.SPEvent(Z._layoutChangedEventName)}return Object.defineProperty(e.prototype,"navigatedEvent",{get:function(){return this._navigatedEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_layoutChangedEvent",{get:function(){return this._privateLayoutChangedEvent},enumerable:!1,configurable:!0}),e}(),ee=function(e){function t(t,n){var a=e.call(this,t)||this;return a.serviceScope.finish(),a._componentTag="Extension."+"".concat(t.manifest.alias,".")+"".concat(t.manifest.id,".")+"".concat(t.manifest.isInternal?"internal":"external",".")+"".concat(t.instanceId),a._placeholderProvider=new _(a.serviceScope,n,a._componentTag),a._applicationAccessor=new $(a.serviceScope),a}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"placeholderProvider",{get:function(){return this._placeholderProvider},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"application",{get:function(){return this._applicationAccessor},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.isDisposed||(this._placeholderProvider.dispose(),delete this._placeholderProvider,delete this._applicationAccessor),e.prototype.dispose.call(this)},t}(o.ExtensionContext)},ut3N:function(e,t){e.exports=f},vlQI:function(e,t){e.exports=p}})});